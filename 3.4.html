<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-book/chapter3/03-04-prepare-2">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">3.4 | Preparing the product dimension (dimProduct) | A Data &amp; Analytics Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.github.com/3.4"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="3.4 | Preparing the product dimension (dimProduct) | A Data &amp; Analytics Wiki"><meta data-rh="true" name="description" content="In this chapter we continue with preparing the product dimension dimProduct. For this table, some transformation steps are the same as for dimCustomer (in general you will notice over time that there is a certain set of transformations that is relevant for almost all data tables). Some transformation steps are new and will broaden your understanding of Power Query."><meta data-rh="true" property="og:description" content="In this chapter we continue with preparing the product dimension dimProduct. For this table, some transformation steps are the same as for dimCustomer (in general you will notice over time that there is a certain set of transformations that is relevant for almost all data tables). Some transformation steps are new and will broaden your understanding of Power Query."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.github.com/3.4"><link data-rh="true" rel="alternate" href="https://www.github.com/3.4" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.github.com/3.4" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="A Data &amp; Analytics Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="A Data &amp; Analytics Wiki Atom Feed"><link rel="stylesheet" href="/assets/css/styles.0e575c3e.css">
<link rel="preload" href="/assets/js/runtime~main.e649a680.js" as="script">
<link rel="preload" href="/assets/js/main.abf7f41f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">A Data &amp; Analytics Wiki</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a class="navbar__item navbar__link" href="/tags">Search by Tags</a><a class="navbar__item navbar__link" href="/category/business-intelligence--analytics-with-microsoft-power-bi-full-book">BI &amp; Analytics with Power BI [Full Book]</a><a class="navbar__item navbar__link" href="/category/articles">Articles</a><a class="navbar__item navbar__link" href="/category/wiki">Wiki</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/blog">Blog</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog">Overview</a></li><li><a class="dropdown__link" href="/blog/tags">All Tags</a></li><li><a class="dropdown__link" href="/blog/tags/project-management">1 | Project Management</a></li><li><a class="dropdown__link" href="/blog/tags/solution-design">2 | Solution Design</a></li><li><a class="dropdown__link" href="/blog/tags/data-transformation">3 | Data Transformation (ETL)</a></li><li><a class="dropdown__link" href="/blog/tags/data-model">4 | Data Model</a></li><li><a class="dropdown__link" href="/blog/tags/data-visualization-reporting">5 | Data Visualization &amp; Reporting</a></li><li><a class="dropdown__link" href="/blog/tags/publishing-sharing">6 | Publishing &amp; Sharing</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/jon-cajacob/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.datavision.ch" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DataVision AG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome &amp; About this Wiki</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/business-intelligence--analytics-with-microsoft-power-bi-full-book">Business Intelligence &amp; Analytics with Microsoft Power BI [Full Book]</a><button aria-label="Toggle the collapsible sidebar category &#x27;Business Intelligence &amp; Analytics with Microsoft Power BI [Full Book]&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/1--introduction">1 | Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;1 | Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/2--overview">2 | Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;2 | Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/category/3--preparing-the-data">3 | Preparing the data</a><button aria-label="Toggle the collapsible sidebar category &#x27;3 | Preparing the data&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.1">3.1 | Chapter overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.2">3.2 | Connecting Power BI with the example data Excel file</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.3">3.3 | Preparing the customer dimension (dimCustomer)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/3.4">3.4 | Preparing the product dimension (dimProduct)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.5">3.5 | Preparing the sales channel dimension (dimSalesChannel)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.6">3.6 | Preparing the date dimension (dimDate)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.7">3.7 | Preparing the sales fact table (factSales)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.8">3.8 | Preparing the sales forecast fact table (factForecast)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.9">3.9 | Organizing Power Query and loading data to the data model</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/4--building-the-data-model">4 | Building the data model</a><button aria-label="Toggle the collapsible sidebar category &#x27;4 | Building the data model&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/5--creating-the-measures-visualizations-and-dashboards">5 | Creating the measures, visualizations and dashboards</a><button aria-label="Toggle the collapsible sidebar category &#x27;5 | Creating the measures, visualizations and dashboards&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/6--publishing-and-sharing-datasets-and-reports-power-bi-service">6 | Publishing and sharing datasets and reports (Power BI Service)</a><button aria-label="Toggle the collapsible sidebar category &#x27;6 | Publishing and sharing datasets and reports (Power BI Service)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/7--guest-chapter-implementing-power-bi-for-the-financial-controlling-department">7 | [Guest Chapter: Implementing Power BI for the Financial Controlling department]</a><button aria-label="Toggle the collapsible sidebar category &#x27;7 | [Guest Chapter: Implementing Power BI for the Financial Controlling department]&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/8--collection-of-topics">8 | Collection of topics</a><button aria-label="Toggle the collapsible sidebar category &#x27;8 | Collection of topics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/9--appendix">9 | Appendix</a><button aria-label="Toggle the collapsible sidebar category &#x27;9 | Appendix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/articles">Articles</a><button aria-label="Toggle the collapsible sidebar category &#x27;Articles&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/wiki">Wiki</a><button aria-label="Toggle the collapsible sidebar category &#x27;Wiki&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/business-intelligence--analytics-with-microsoft-power-bi-full-book"><span itemprop="name">Business Intelligence &amp; Analytics with Microsoft Power BI [Full Book]</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/3--preparing-the-data"><span itemprop="name">3 | Preparing the data</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">3.4 | Preparing the product dimension (dimProduct)</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>3.4 | Preparing the product dimension (<em>dimProduct</em>)</h1><p>In this chapter we continue with preparing the product dimension <em>dimProduct</em>. For this table, some transformation steps are the same as for dimCustomer (in general you will notice over time that there is a certain set of transformations that is relevant for almost all data tables). Some transformation steps are new and will broaden your understanding of Power Query.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-inspect-the-raw-data-table">1. Inspect the (raw) data table<a href="#1-inspect-the-raw-data-table" class="hash-link" aria-label="Direct link to 1. Inspect the (raw) data table" title="Direct link to 1. Inspect the (raw) data table">​</a></h4><p>As for dimCustomer, we first want to inspect the table to understand the transformations we need to apply. Here again, Power Query automatically applied some basic steps like promoting the headers and changing column data types.</p><p>Unlike in dimCustomer, column headers are correctly set from the start (because in the underlying excel the column headers are in the first row). Before setting the data type for each column, let&#x27;s select only the columns which we actually need for the analysis.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-select-the-columns-needed">2. Select the columns needed<a href="#2-select-the-columns-needed" class="hash-link" aria-label="Direct link to 2. Select the columns needed" title="Direct link to 2. Select the columns needed">​</a></h4><p>Select the transformation step <em>Promoted Headers</em> and follow <em>Home → Choose Columns</em> to select the columns needed.</p><p>When you do that, Power Query asks you to confirm inserting a transformation step between two existing ones. Confirm that with <em>Insert</em>:</p><p><img loading="lazy" alt="03-20" src="/assets/images/img_book_03-20-0bd61e3cd980a55191822c49f568e306.png" width="1299" height="266" class="img_ev3q"></p><p>For the upcoming transformation steps we only need the following columns:</p><p><img loading="lazy" alt="03-19" src="/assets/images/img_book_03-19-03435a2e32db624c5f34ba83bca9a7ef.png" width="1323" height="875" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-check-and-adjust-the-data-types">3. Check and adjust the data types<a href="#3-check-and-adjust-the-data-types" class="hash-link" aria-label="Direct link to 3. Check and adjust the data types" title="Direct link to 3. Check and adjust the data types">​</a></h4><p>Select the transformation step <em>Changed Type</em> in order to inspect the data types that Power Query has automatically set.</p><p>Immediately, we encounter an error:</p><p><img loading="lazy" alt="03-21" src="/assets/images/img_book_03-21-7dcf7f259a95f5208ff82fff0f906d8d.png" width="1318" height="538" class="img_ev3q"></p><p>This error occurs because in the transformation step <em>Changed Type</em>, which Power Query automatically created when connecting the Excel, the code refers to columns which we actually removed in the precedent step <em>Removed Other Columns</em>. Because Power Query cannot find these removed columns anymore, e.g. the column <em>_xCALC1</em>, it gives us back an error.</p><p>The simplest way to remediate this error is to delete the step <em>Changed Type</em> and create a new one with simply setting the data type for the selected columns. As for dimCustomer, we neither have a date column nor columns holding numerical information with which we want to perform calculations. Therefore, define all columns to be the data type <em>text</em>.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>The transformation steps <em>Promoted Headers</em>, <em>Removed Other Columns</em> and <em>Changed Type</em> are pretty much always used and applied to all queries in Power Query, usually as the first few transformation steps for a data table.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-combine-product-id-and-product-desc-in-a-new-custom-calculated-column">4. Combine <em>Product ID</em> and <em>Product Desc</em> in a new custom calculated column<a href="#4-combine-product-id-and-product-desc-in-a-new-custom-calculated-column" class="hash-link" aria-label="Direct link to 4-combine-product-id-and-product-desc-in-a-new-custom-calculated-column" title="Direct link to 4-combine-product-id-and-product-desc-in-a-new-custom-calculated-column">​</a></h4><p>As for dimCustomer, we want to create a new column which combines the ID and description of each product which is very useful later on when a user searches for a product by its description or ID.</p><p><em>Add Column → Custom Column</em></p><p>In the appearing window, name the new column <em>Product</em> and enter the following code:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">New calculated column: Customer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">Product</span><span class="token plain"> </span><span class="token maybe-class-name">Desc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; (&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">Product</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ID</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And in a next step, change the data type of the newly added column to <em>text</em>.</p><p>After doing these steps, your Power Query should look like the following:</p><p><img loading="lazy" alt="03-22" src="/assets/images/img_book_03-22-86bbdac2b87ef8e88957a336a21ab5a3.png" width="1322" height="728" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-join-merge-the-table-helperproductcategory">5. Join (merge) the table <em>helperProductCategory</em><a href="#5-join-merge-the-table-helperproductcategory" class="hash-link" aria-label="Direct link to 5-join-merge-the-table-helperproductcategory" title="Direct link to 5-join-merge-the-table-helperproductcategory">​</a></h4><p>In the next step, we want to combine two tables with a table join. In Power Query, joins are called <em>merges</em>. One way to think about or understand a table join is to compare with a lookup in an Excel spreadsheet. Essentially, we are looking for matching members in the other (mapping) table and retrieve information from there based on a shared key (usually an ID).</p><p>In our <em>dimProduct</em> table we see there is a column <em>Subcategory ID</em>. Navigating to the table <em>helperProductCategory</em>, we can see there is also a column <em>Subcategory ID</em> and some additional namings for the product subcategories and categories. The goal is to map these subcategories and categories to our <em>dimProduct</em> table.</p><p>Before we combine the two tables, let&#x27;s make sure the mapping table <em>helperProductCategory</em> is in a good shape. For that, navigate to helperProductCategory in the navigation on the left side of the Power Query interface.</p><p>Make sure the following steps are applied to the mapping table:</p><ul><li>Select only the columns <em>Subcategory ID</em>, <em>Subcategory</em>, <em>Category</em></li><li>Change the data type to text for all selected columns</li><li>Remove duplicates from the column Subcategory ID (note, this is more for safety reasons as there are currently no duplicates, but maybe if the data source changes in the future we want to make sure there are never duplicates in this mapping table)</li></ul><p>Power Query should look like this for <em>helperProductCategory</em>:</p><p><img loading="lazy" alt="03-24" src="/assets/images/img_book_03-24-2959aaf786092440ab03648597774d7b.png" width="1321" height="619" class="img_ev3q"></p><p>Now we can navigate back to <em>dimProduct</em> and perform the table join.</p><p><em>Home → Merge Queries</em></p><p><img loading="lazy" alt="03-23" src="/assets/images/img_book_03-23-465978f498b46708d63d2a24821d6568.png" width="1320" height="698" class="img_ev3q"></p><p>In the appearing window, select <em>helperProductCategory</em> as the second table (the table on the right of the join). Then, select in both tables the columns <em>Subcategory ID</em> (they should be grey as in the screenshot). Leave the join type on &#x27;Left Outer (...)&#x27; and confirm with <em>OK</em>.</p><p><img loading="lazy" alt="03-25" src="/assets/images/img_book_03-25-45d465a2a4857db898154ffc52dd369f.png" width="1304" height="717" class="img_ev3q"></p><p>A new step <em>Merged Queries</em> should have appeard in <em>APPLIED STEPS</em>. From here, we have to select which columns of <em>helperProductCategory</em> we want to actually add to <em>dimProduct</em>.</p><p>In the newly added column, click on the symbol at the right end of the column header. Select the columns you want to add (plus, de-select the option about original column name prefixes) and confirm with OK.</p><p>Note, we de-selected <em>Subcategory ID</em> because this information already exists as a column in <em>dimProduct</em>.</p><p><img loading="lazy" alt="03-26" src="/assets/images/img_book_03-26-2baa07381cb759cdbb3e0b4acfd8f69e.png" width="1318" height="718" class="img_ev3q"></p><p>Your Power Query should like this now:</p><p><img loading="lazy" alt="03-27" src="/assets/images/img_book_03-27-ae1e03cf8ea8c8d680ba003eedb084f4.png" width="1319" height="760" class="img_ev3q"></p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Before combining any two tables, make sure there are no duplicates in the column containing the mapping key in the mapping table. If there are duplicates, data is multiplied upon joining the two tables resulting in duplicated rows in the combined table.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-disable-loading-the-mapping-table-helperproductcategory">6. Disable loading the mapping table <em>helperProductCategory</em><a href="#6-disable-loading-the-mapping-table-helperproductcategory" class="hash-link" aria-label="Direct link to 6-disable-loading-the-mapping-table-helperproductcategory" title="Direct link to 6-disable-loading-the-mapping-table-helperproductcategory">​</a></h4><p>In the previous step we used the table <em>helperProductCategory</em> to map product subcategory and category information to <em>dimProduct</em>. It functions as a supporting table and as such we do not need to load it to the final data model.</p><p>To disable loading this table, do a right-click on the table and click on <em>Enable Load</em>:</p><p><img loading="lazy" alt="03-28" src="/assets/images/img_book_03-28-8b16b4a210e973a0c1ecfa1ad7a190c7.png" width="1321" height="714" class="img_ev3q"></p><p>After disabling loading the table, its label should be appear in italic font.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="7-create-a-small-mapping-table-helperproducttype-by-manual-input-and-join-it-with-dimproduct">7. Create a small mapping table <em>helperProductType</em> by manual input and join it with <em>dimProduct</em><a href="#7-create-a-small-mapping-table-helperproducttype-by-manual-input-and-join-it-with-dimproduct" class="hash-link" aria-label="Direct link to 7-create-a-small-mapping-table-helperproducttype-by-manual-input-and-join-it-with-dimproduct" title="Direct link to 7-create-a-small-mapping-table-helperproducttype-by-manual-input-and-join-it-with-dimproduct">​</a></h4><p>In our dimProduct table we can see there is a column with a rather technical label <em>_xPROD_TYPE</em> that contains some abbreviations. There are two distinct abbreviations, <em>xl_TRAD</em> and <em>xl_MANUF</em>. The provider of the data source tells us that the former stands for trade products and the latter for manufactured products. Because we do not want present such technical terms or abbreviations in any dashboard, let&#x27;s replace these abbreviations with more speaking names.</p><p>One way to do this would be by replacing values, however this operation we already saw for <em>dimCustomer</em> and hence here I want to show another way: creating a small mapping table to be joined with dimProduct.</p><p>First, create the small table mapping the abbreviations to speaking names and call it <em>helperProductType</em>. For that, click on <em>Enter Data</em> under <em>Home</em> and a window appears that allows us to manually enter values into a table:</p><p><img loading="lazy" alt="03-29" src="/assets/images/img_book_03-29-0061fedeede5f6c121dd2d2e157f5870.png" width="1322" height="872" class="img_ev3q"></p><p>Confirm with <em>OK</em> and a new table shows up under <em>Queries</em> on the left. Navigate to the table and confirm it looks as intendend. Then, as in the previous step, disable loading the table.</p><p>Navigate back to <em>dimProduct</em> and perform the table join as follows:</p><p><img loading="lazy" alt="03-30" src="/assets/images/img_book_03-30-043a93ca1701c9f832a7b6843cdeb8a9.png" width="1309" height="712" class="img_ev3q"></p><p>Then, expand the new column <em>ProductType</em> in <em>dimProduct</em>.</p><p>The table <em>dimProduct</em> should now like the following:</p><p><img loading="lazy" alt="03-31" src="/assets/images/img_book_03-31-f0e45065edf4530823cb3264aab4663d.png" width="1322" height="698" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8-remove-the-column-_xlprod_type">8. Remove the column _xlPROD_TYPE<a href="#8-remove-the-column-_xlprod_type" class="hash-link" aria-label="Direct link to 8. Remove the column _xlPROD_TYPE" title="Direct link to 8. Remove the column _xlPROD_TYPE">​</a></h4><p>We do not need the product type abbreviations anymore so let&#x27;s remove the column:</p><p><img loading="lazy" alt="03-32" src="/assets/images/img_book_03-32-e851ec807267ff8e35b5db1542355f89.png" width="1327" height="788" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Alternatively, simply select the columns you want to remove and press the <strong>delete key</strong> on your keyboard.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="9-remove-duplicates-from-column-product-id">9. Remove duplicates from column <em>Product ID</em><a href="#9-remove-duplicates-from-column-product-id" class="hash-link" aria-label="Direct link to 9-remove-duplicates-from-column-product-id" title="Direct link to 9-remove-duplicates-from-column-product-id">​</a></h4><p>Currently, there are no duplicates in <em>Product ID</em>. However, we want to avoid problems in the future in case duplicates suddenly show up in the source data. Because <em>dimProduct</em> is a dimension table and we will later use <em>Product ID</em> as the key to connect with the fact data, there would be an error on refreshing the dataset in case of duplicate entries in <em>Product ID</em>. So this last step is a <strong>safety measure to increase the robustness</strong> of the data model.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/3-preparing-the-data">3 | Preparing the data</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/3.3"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">3.3 | Preparing the customer dimension (dimCustomer)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/3.5"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3.5 | Preparing the sales channel dimension (dimSalesChannel)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-inspect-the-raw-data-table" class="table-of-contents__link toc-highlight">1. Inspect the (raw) data table</a></li><li><a href="#2-select-the-columns-needed" class="table-of-contents__link toc-highlight">2. Select the columns needed</a></li><li><a href="#3-check-and-adjust-the-data-types" class="table-of-contents__link toc-highlight">3. Check and adjust the data types</a></li><li><a href="#4-combine-product-id-and-product-desc-in-a-new-custom-calculated-column" class="table-of-contents__link toc-highlight">4. Combine <em>Product ID</em> and <em>Product Desc</em> in a new custom calculated column</a></li><li><a href="#5-join-merge-the-table-helperproductcategory" class="table-of-contents__link toc-highlight">5. Join (merge) the table <em>helperProductCategory</em></a></li><li><a href="#6-disable-loading-the-mapping-table-helperproductcategory" class="table-of-contents__link toc-highlight">6. Disable loading the mapping table <em>helperProductCategory</em></a></li><li><a href="#7-create-a-small-mapping-table-helperproducttype-by-manual-input-and-join-it-with-dimproduct" class="table-of-contents__link toc-highlight">7. Create a small mapping table <em>helperProductType</em> by manual input and join it with <em>dimProduct</em></a></li><li><a href="#8-remove-the-column-_xlprod_type" class="table-of-contents__link toc-highlight">8. Remove the column _xlPROD_TYPE</a></li><li><a href="#9-remove-duplicates-from-column-product-id" class="table-of-contents__link toc-highlight">9. Remove duplicates from column <em>Product ID</em></a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Wiki</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/category/business-intelligence--analytics-with-microsoft-power-bi-full-book">Business Intelligence &amp; Analytics with Microsoft Power BI [Full Book]</a></li></ul></div><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/tags/project-management">1 | Project Management</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/solution-design">2 | Solution Design</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-transformation">3 | Data Transformation</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-model">4 | Data Model</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-visualization-reporting">5 | Data Visualization &amp; Reporting</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/publishing-sharing">6 | Publishing &amp; Sharing</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/jon-cajacob/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.datavision.ch/" target="_blank" rel="noopener noreferrer" class="footer__link-item">DataVision AG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/imprint">Imprint</a></li><li class="footer__item"><a class="footer__link-item" href="/data-privacy">Data Privacy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 A Data & Analytics Wiki by Jon Cajacob, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e649a680.js"></script>
<script src="/assets/js/main.abf7f41f.js"></script>
</body>
</html>