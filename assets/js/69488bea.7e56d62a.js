"use strict";(self.webpackChunkdata_and_analytics=self.webpackChunkdata_and_analytics||[]).push([[2056],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>u});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=r.createContext({}),c=function(e){var t=r.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=c(e.components);return r.createElement(i.Provider,{value:t},e.children)},h="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),h=c(a),m=n,u=h["".concat(i,".").concat(m)]||h[m]||d[m]||o;return a?r.createElement(u,l(l({ref:t},p),{},{components:a})):r.createElement(u,l({ref:t},p))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,l=new Array(o);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[h]="string"==typeof e?e:n,l[1]=s;for(var c=2;c<o;c++)l[c]=a[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},62611:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=a(87462),n=(a(67294),a(3905));const o={sidebar_position:999,title:"3.8 | Preparing the sales forecast fact table (factForecast)",slug:"/3.8",tags:["3 | Preparing the data"]},l="3.8 | Preparing the sales forecast fact table (*factForecast*)",s={unversionedId:"book/chapter3/03-08-prepare-6",id:"book/chapter3/03-08-prepare-6",title:"3.8 | Preparing the sales forecast fact table (factForecast)",description:"In the previous chapter we prepared the fact table factSales which contains the actual sales transactions that happened over time. In many real-world use-cases plan data is integrated in the BI solution in order to allow comparisons and better judge performance.",source:"@site/docs/01-book/01-chapter3/03-08-prepare-6.md",sourceDirName:"01-book/01-chapter3",slug:"/3.8",permalink:"/3.8",draft:!1,tags:[{label:"3 | Preparing the data",permalink:"/tags/3-preparing-the-data"}],version:"current",sidebarPosition:999,frontMatter:{sidebar_position:999,title:"3.8 | Preparing the sales forecast fact table (factForecast)",slug:"/3.8",tags:["3 | Preparing the data"]},sidebar:"tutorialSidebar",previous:{title:"3.7 | Preparing the sales fact table (factSales)",permalink:"/3.7"},next:{title:"3.9 | Organizing Power Query and loading data to the data model",permalink:"/3.9"}},i={},c=[{value:"1. Navigate to the table <em>factForecast</em>",id:"1-navigate-to-the-table-factforecast",level:4},{value:"2. Delete the automatically generated step <em>Changed Type</em>",id:"2-delete-the-automatically-generated-step-changed-type",level:4},{value:"3. Promote the top row to become the table headers",id:"3-promote-the-top-row-to-become-the-table-headers",level:4},{value:"4. Delete the automatically generated step <em>Changed Type</em>",id:"4-delete-the-automatically-generated-step-changed-type",level:4},{value:"5. Unpivot the columns containing forecast values",id:"5-unpivot-the-columns-containing-forecast-values",level:4},{value:"6. Rename the newly created columns",id:"6-rename-the-newly-created-columns",level:4},{value:"7. Set the data type for all columns",id:"7-set-the-data-type-for-all-columns",level:4},{value:"8. Clean the table from errors",id:"8-clean-the-table-from-errors",level:4}],p={toc:c};function h(e){let{components:t,...o}=e;return(0,n.kt)("wrapper",(0,r.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"38--preparing-the-sales-forecast-fact-table-factforecast"},"3.8 | Preparing the sales forecast fact table (",(0,n.kt)("em",{parentName:"h1"},"factForecast"),")"),(0,n.kt)("p",null,"In the previous chapter we prepared the fact table factSales which contains the actual sales transactions that happened over time. In many real-world use-cases plan data is integrated in the BI solution in order to allow comparisons and better judge performance."),(0,n.kt)("p",null,"For our example use-case we have a table with forecasted sales data which we want to integrate into the data model. Let's prepare the table."),(0,n.kt)("h4",{id:"1-navigate-to-the-table-factforecast"},"1. Navigate to the table ",(0,n.kt)("em",{parentName:"h4"},"factForecast")),(0,n.kt)("h4",{id:"2-delete-the-automatically-generated-step-changed-type"},"2. Delete the automatically generated step ",(0,n.kt)("em",{parentName:"h4"},"Changed Type")),(0,n.kt)("h4",{id:"3-promote-the-top-row-to-become-the-table-headers"},"3. Promote the top row to become the table headers"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-46",src:a(15788).Z,width:"1320",height:"610"})),(0,n.kt)("h4",{id:"4-delete-the-automatically-generated-step-changed-type"},"4. Delete the automatically generated step ",(0,n.kt)("em",{parentName:"h4"},"Changed Type")),(0,n.kt)("p",null,"When promoting a row to become table headers, Power Query always attempts to guess the right data type for each column and creates a transformation step accordingly. We do that later and therefore please delete this step."),(0,n.kt)("h4",{id:"5-unpivot-the-columns-containing-forecast-values"},"5. Unpivot the columns containing forecast values"),(0,n.kt)("p",null,"Now when we inspect the table, we can see that apart from ",(0,n.kt)("em",{parentName:"p"},"Product ID"),", each column has a particular month in date format as its column header. This is a typical format with which planning data is generated. It is however not a useful structure when working with a BI tool."),(0,n.kt)("p",null,"To restructure the table into a more useful format, we simply unpivot all columns except ",(0,n.kt)("em",{parentName:"p"},"Product ID"),". To do that, do a right-click on the column header of ",(0,n.kt)("em",{parentName:"p"},"Product ID")," and select ",(0,n.kt)("em",{parentName:"p"},"Unpivot Other Columns"),":"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-47",src:a(93559).Z,width:"1321",height:"794"})),(0,n.kt)("p",null,"The table then should look like this:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-48",src:a(30543).Z,width:"1321",height:"619"})),(0,n.kt)("p",null,"As you can see, the previous table headers are now stored in a new column ",(0,n.kt)("em",{parentName:"p"},"Attribute")," and the respective forecast values are in the column ",(0,n.kt)("em",{parentName:"p"},"Value"),". Let's rename these table headers in the next step."),(0,n.kt)("h4",{id:"6-rename-the-newly-created-columns"},"6. Rename the newly created columns"),(0,n.kt)("p",null,"Rename ",(0,n.kt)("em",{parentName:"p"},"Attribute")," to ",(0,n.kt)("em",{parentName:"p"},"Date")," and ",(0,n.kt)("em",{parentName:"p"},"Value")," to ",(0,n.kt)("em",{parentName:"p"},"Sales in USD")," respectively. Remember, either do a double-click on the header name to rename or a right-click and select ",(0,n.kt)("em",{parentName:"p"},"Rename"),"."),(0,n.kt)("h4",{id:"7-set-the-data-type-for-all-columns"},"7. Set the data type for all columns"),(0,n.kt)("p",null,"Convert the column ",(0,n.kt)("em",{parentName:"p"},"Date")," to data type ",(0,n.kt)("em",{parentName:"p"},"date"),", ",(0,n.kt)("em",{parentName:"p"},"Sales in USD")," to ",(0,n.kt)("em",{parentName:"p"},"Decimal number")," and ",(0,n.kt)("em",{parentName:"p"},"Product ID")," to data type ",(0,n.kt)("em",{parentName:"p"},"text"),"."),(0,n.kt)("h4",{id:"8-clean-the-table-from-errors"},"8. Clean the table from errors"),(0,n.kt)("p",null,"Upon inspecting the table preview, Power Query tells us that there are errors in the column ",(0,n.kt)("em",{parentName:"p"},"Sales in USD"),". There is an indication just below the table header that tells us the quality and completness of a column (see further below for more details). If you scroll down a bit in the table, you should see the errors."),(0,n.kt)("p",null,"When clicking into the cell of one of the errors (",(0,n.kt)("ins",null,"NOT")," on the text ",(0,n.kt)("em",{parentName:"p"},"Error"),"), Power Query shows the error message in yellow:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-49",src:a(56324).Z,width:"1323",height:"881"})),(0,n.kt)("p",null,"It seems that there are formula errors in the underlying Excel table (#DIV/0). Note, this is a very common occurence when working with Excel files as data sources."),(0,n.kt)("p",null,"Usually we would not go back to the provider of the forecast data and let the errors be fixed and replaced with the proper values. For our demo use-case we now simply replace the errors with zeros in order to be able to move on and load the table to the data model. Like this, you also learn a new transformation step. However, please feel free to enter some figures in the erroneous cells in the Excel file (make sure to hit ",(0,n.kt)("em",{parentName:"p"},"Refresh Preview")," after saving the changes to the Excel file in order to see the changes in Power Query)."),(0,n.kt)("p",null,"Simply do a right-click on the respective column header and select Replace Errors:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-50",src:a(56546).Z,width:"1321",height:"741"})),(0,n.kt)("p",null,"In the appearing window, enter a zero and confirm with ",(0,n.kt)("em",{parentName:"p"},"OK"),":"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-51",src:a(64674).Z,width:"1310",height:"252"})),(0,n.kt)("p",null,"The errors should be gone and there should not be any indication red indication just below the column header."),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"Under ",(0,n.kt)("em",{parentName:"p"},"View")," \u2192 ",(0,n.kt)("em",{parentName:"p"},"Data Preview")," there are different features to analyze the quality and profile of the table columns.\n",(0,n.kt)("img",{alt:"03-52",src:a(50735).Z,width:"1323",height:"878"}))),(0,n.kt)("p",null,"We are now down with preparing all tables. In the following chapter, we will tidy up Power Query and load the data to the data model."))}h.isMDXComponent=!0},15788:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-46-f30390cad558aa298d52abdd163d4803.png"},93559:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-47-a67bdbd3ce2dc78836acff4c715099fb.png"},30543:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-48-bc8d26c8fd0548ec29f62a41df9d4dd0.png"},56324:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-49-8612dc548a6f7f24b1e543aa993a5b8a.png"},56546:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-50-457b7682b6fa488b67c0c958266fc2bd.png"},64674:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-51-2e5366e19400b2b8e7394f71d79aafd6.png"},50735:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-52-45fd93c0b8aa494b1dd71089d93a4f4e.png"}}]);