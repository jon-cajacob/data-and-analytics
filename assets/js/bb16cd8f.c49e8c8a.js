"use strict";(self.webpackChunkdata_and_analytics=self.webpackChunkdata_and_analytics||[]).push([[7324],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var r=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,o=function(e,t){if(null==e)return{};var a,r,o={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var a=e.components,o=e.mdxType,n=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(a),f=o,m=u["".concat(l,".").concat(f)]||u[f]||p[f]||n;return a?r.createElement(m,i(i({ref:t},d),{},{components:a})):r.createElement(m,i({ref:t},d))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=a.length,i=new Array(n);i[0]=f;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:o,i[1]=s;for(var c=2;c<n;c++)i[c]=a[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}f.displayName="MDXCreateElement"},5171:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>n,metadata:()=>s,toc:()=>c});var r=a(7462),o=(a(7294),a(3905));const n={sidebar_position:999,title:"2.3 | Power Query",slug:"/2.3",tags:["tag1"]},i="2.2 | Power Query",s={unversionedId:"book/chapter2/02-03-powerquery",id:"book/chapter2/02-03-powerquery",title:"2.3 | Power Query",description:'Power Query is a data transformation tool built into Power BI and Microsoft Excel. With Power Query, we can connect with various different data sources, extract required data and transform and load it into tables (dimensions and facts) which can be used to build the data model. This process is generally referred to "ETL", whichs stands for extract, transform and load. Preparing data is necessary and important because data in its raw form stored in data sources is rarely in the shape required for the business intelligence solution.',source:"@site/docs/01-book/01-chapter2/02-03-powerquery.md",sourceDirName:"01-book/01-chapter2",slug:"/2.3",permalink:"/2.3",draft:!1,tags:[{label:"tag1",permalink:"/tags/tag-1"}],version:"current",sidebarPosition:999,frontMatter:{sidebar_position:999,title:"2.3 | Power Query",slug:"/2.3",tags:["tag1"]},sidebar:"tutorialSidebar",previous:{title:"2.2 | Power BI from Microsoft",permalink:"/2.2"},next:{title:"2.4 | Building blocks of a business intelligence solution",permalink:"/2.4"}},l={},c=[{value:"2.2.1 | Overview of the Power Query user interface",id:"221--overview-of-the-power-query-user-interface",level:2},{value:"2.2.2 | Recommended order of data transformations",id:"222--recommended-order-of-data-transformations",level:2},{value:"2.2.3 | Using the right data types for table columns",id:"223--using-the-right-data-types-for-table-columns",level:2}],d={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"22--power-query"},"2.2 | Power Query"),(0,o.kt)("p",null,'Power Query is a data transformation tool built into Power BI and Microsoft Excel. With Power Query, we can connect with various different data sources, extract required data and transform and load it into tables (dimensions and facts) which can be used to build the data model. This process is generally referred to "ETL", whichs stands for extract, transform and load. Preparing data is necessary and important because data in its raw form stored in data sources is rarely in the shape required for the business intelligence solution.'),(0,o.kt)("p",null,"Power Query is considered a very powerful tool not just because of its breadth of functionality, but also because it is ",(0,o.kt)("strong",{parentName:"p"},"low-code")," like Power BI and most features are accessible via buttons, dropdowns, guided settings windows and input fields on the user interface. When a data transformation step is applied to the data table, code is generated in the background. It is always possible to directly work with and adjust this code if required, hence giving the user maximum flexibility. Further, for each table I can always easily follow the transformation steps and see intermediate results (see bullet no. 4 below)."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Power Query Workflow",src:a(6267).Z,width:"1483",height:"831"})),(0,o.kt)("div",{align:"center"},(0,o.kt)("font",{size:"3"},"Power Query workflow")),(0,o.kt)("br",null),(0,o.kt)("p",null,"In the example use-case of this book, we will go through many of the most important data transformation operations available in Power Query. For now, as for Power BI Desktop, I want to give an overview of the user interface based on the following screenshot."),(0,o.kt)("h2",{id:"221--overview-of-the-power-query-user-interface"},"2.2.1 | Overview of the Power Query user interface"),(0,o.kt)("p",null,"The following screenshot shows an overview of the Power Query interface. Please note, all important elements are covered later when building the model based on the demo data."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Power Query User Interface",src:a(1266).Z,width:"2015",height:"1140"})),(0,o.kt)("div",{align:"center"},(0,o.kt)("font",{size:"3"},"Overview of the most important elements on the Power Query user interface (right-click and open in new tab for large version)")),(0,o.kt)("br",null),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Description")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Changes to the data transformation process in Power Query have to be applied to the data model in order for them to take effect"),(0,o.kt)("li",{parentName:"ol"},"Connect with a new data source"),(0,o.kt)("li",{parentName:"ol"},"Navigation between the different queries (i.e. tables which can be intermediate tables in the transformation process or final tables being loaded to the data model)"),(0,o.kt)("li",{parentName:"ol"},"Data transformation steps of the currently selected query (from top to bottom). Click on a step to see the intermediate transformation results. New steps are always added right after the step that is currently selected"),(0,o.kt)("li",{parentName:"ol"},"Formula bar showing the functional code of the currently selected transformation step. The formula language is called ",(0,o.kt)("strong",{parentName:"li"},"M")," ",(0,o.kt)("sup",{parentName:"li",id:"fnref-1"},(0,o.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,o.kt)("li",{parentName:"ol"},"Table headers which is the place to apply filters (as in Microsoft Excel), rename headers or apply various transformations via right-click"),(0,o.kt)("li",{parentName:"ol"},"Selection and removal of columns"),(0,o.kt)("li",{parentName:"ol"},"Promote the first row of a table to be the headers"),(0,o.kt)("li",{parentName:"ol"},"Join (merge) and union (append) multiple queries")),(0,o.kt)("h2",{id:"222--recommended-order-of-data-transformations"},"2.2.2 | Recommended order of data transformations"),(0,o.kt)("p",null,"When we transform data step-by-step, there is a certain (generalized) order of steps that should be followed. In particular, it is best practice to reduce the amount of data to the scope needed as early in the process as possible. Therefore, I want to recommend the following generalized order of data transformations to be applied to a table."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Promote the top row to become the table headers"),(0,o.kt)("li",{parentName:"ol"},"Select the columns needed (remove the ones not needed for the BI solution)"),(0,o.kt)("li",{parentName:"ol"},"Filter the table for the rows needed"),(0,o.kt)("li",{parentName:"ol"},"Define the data type of each column (dates to type date, numbers to type decimals etc.)"),(0,o.kt)("li",{parentName:"ol"},"Aggregate (group by) rows"),(0,o.kt)("li",{parentName:"ol"},"Union with another table"),(0,o.kt)("li",{parentName:"ol"},"Cleansing of data (replace values, removing errors etc.)"),(0,o.kt)("li",{parentName:"ol"},"Pivot / unpivot columns"),(0,o.kt)("li",{parentName:"ol"},"Create custom calculated columns"),(0,o.kt)("li",{parentName:"ol"},"Remove duplicate values in key columns")),(0,o.kt)("p",null,"Please note, each ETL process has its unique requirements and of course the order just presented cannot be put in place 1:1 in most cases. But it can be used as a helpful reference."),(0,o.kt)("h2",{id:"223--using-the-right-data-types-for-table-columns"},"2.2.3 | Using the right data types for table columns"),(0,o.kt)("p",null,"In important part of any ETL process is to define the data type for each column of a data table. This is important to make sure any calculations based on the table columns and relationships between tables work in the intendend way. Further, we want to store data in an efficient way in the data model."),(0,o.kt)("p",null,"Power Query offers the following data types options:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Data types available in Power BI",src:a(6046).Z,width:"1398",height:"492"})),(0,o.kt)("div",{align:"center"},(0,o.kt)("font",{size:"3"},"Data types available in Power BI")),(0,o.kt)("br",null),(0,o.kt)("p",null,'There is a rule I strictly follow when defining data types and it goes as follows: Everything has to be the data type "Text", except numbers we want to perform calculations with and dates. This is a simple rule that can be applied to almost all use-cases and I certainly did so when implementing dozens of BI solutions.'),(0,o.kt)("p",null,"The crucial thing to note is that when a column only contains numbers but we do not want to perform any sort of calculation with it - this is for example the case for any \"ID\" column containing numerical IDs - it has to be the data type text. The reason is simple: Often times ID-columns are used to link tables with each other and we want to 100% sure, that these keys are interpreted in the right way. I have seen cases of IDs like '001' and '00001'. When defining such a column as a numerical data type, it will be '1' in both these cases, although they are actually not the same."),(0,o.kt)("div",{className:"footnotes"},(0,o.kt)("hr",{parentName:"div"}),(0,o.kt)("ol",{parentName:"div"},(0,o.kt)("li",{parentName:"ol",id:"fn-1"},"Power Query M formular language documentation: ",(0,o.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/powerquery-m/"},(0,o.kt)("ins",null,"M Documentation")),(0,o.kt)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"\u21a9")))))}u.isMDXComponent=!0},6046:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_02-18-82b1f62d482e764f15aa0ae62da34759.png"},1266:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_02-3-f55c54aeafa9693fb36a5f883a639385.png"},6267:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_02-4-8cb810b09268f78f927cebdb4b319ee8.png"}}]);