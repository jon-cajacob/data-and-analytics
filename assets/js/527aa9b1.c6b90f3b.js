"use strict";(self.webpackChunkdata_and_analytics=self.webpackChunkdata_and_analytics||[]).push([[5667],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>u});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),m=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=m(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=m(a),h=o,u=c["".concat(s,".").concat(h)]||c[h]||d[h]||r;return a?n.createElement(u,i(i({ref:t},p),{},{components:a})):n.createElement(u,i({ref:t},p))}));function u(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:o,i[1]=l;for(var m=2;m<r;m++)i[m]=a[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},4332:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>m});var n=a(7462),o=(a(7294),a(3905));const r={sidebar_position:999,title:"3.3 | Preparing the customer dimension (dimCustomer)",slug:"/3.3",tags:["3 | Preparing the data"]},i="3.3 | Preparing the customer dimension (*dimCustomer*)",l={unversionedId:"book/chapter3/03-03-prepare-1",id:"book/chapter3/03-03-prepare-1",title:"3.3 | Preparing the customer dimension (dimCustomer)",description:"After connecting the Excel file and its data tables, we will now proceed with preparing the individual dimension and fact tables using data transformation steps in Power Query. The first dimension we will prepare is the customer dimension containing respective master data.",source:"@site/docs/01-book/01-chapter3/03-03-prepare-1.md",sourceDirName:"01-book/01-chapter3",slug:"/3.3",permalink:"/3.3",draft:!1,tags:[{label:"3 | Preparing the data",permalink:"/tags/3-preparing-the-data"}],version:"current",sidebarPosition:999,frontMatter:{sidebar_position:999,title:"3.3 | Preparing the customer dimension (dimCustomer)",slug:"/3.3",tags:["3 | Preparing the data"]},sidebar:"tutorialSidebar",previous:{title:"3.2 | Connecting Power BI with the example data Excel file",permalink:"/3.2"},next:{title:"3.4 | Preparing the product dimension (dimProduct)",permalink:"/3.4"}},s={},m=[{value:"1. Inspect the (raw) data table",id:"1-inspect-the-raw-data-table",level:4},{value:"2. Delete the automatically generated steps <em>Promoted Headers</em> and <em>Changed Type</em>",id:"2-delete-the-automatically-generated-steps-promoted-headers-and-changed-type",level:4},{value:"3. Remove the first two rows before promoting the header row",id:"3-remove-the-first-two-rows-before-promoting-the-header-row",level:4},{value:"4. Select the columns needed",id:"4-select-the-columns-needed",level:4},{value:"5. Set the data type for each column",id:"5-set-the-data-type-for-each-column",level:4},{value:"6. Capitalize all words in column <em>Segment</em>",id:"6-capitalize-all-words-in-column-segment",level:4},{value:"7. Replace values in column <em>Country</em>",id:"7-replace-values-in-column-country",level:4},{value:"8. Combine <em>Customer ID</em> and <em>Customer Desc</em> in a new custom calculated column",id:"8-combine-customer-id-and-customer-desc-in-a-new-custom-calculated-column",level:4},{value:"9. Final step: Remove duplicates in column <em>Customer ID</em>",id:"9-final-step-remove-duplicates-in-column-customer-id",level:4}],p={toc:m};function c(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"33--preparing-the-customer-dimension-dimcustomer"},"3.3 | Preparing the customer dimension (",(0,o.kt)("em",{parentName:"h1"},"dimCustomer"),")"),(0,o.kt)("p",null,"After connecting the Excel file and its data tables, we will now proceed with preparing the individual dimension and fact tables using data transformation steps in Power Query. The first dimension we will prepare is the customer dimension containing respective master data."),(0,o.kt)("h4",{id:"1-inspect-the-raw-data-table"},"1. Inspect the (raw) data table"),(0,o.kt)("p",null,"First, let's have a look at the customer data table ",(0,o.kt)("em",{parentName:"p"},"dimCustomer")," in order to understand the transformations we have to apply to the data."),(0,o.kt)("p",null,"When connecting with the Excel file, Power BI has automatically applied some basic steps to the table as we can see on the right side under ",(0,o.kt)("em",{parentName:"p"},"APPLIED STEPS"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-4",src:a(6477).Z,width:"1321",height:"880"})),(0,o.kt)("p",null,"The steps ",(0,o.kt)("em",{parentName:"p"},"Source")," and ",(0,o.kt)("em",{parentName:"p"},"Navigation")," are needed in order for Power BI know where the Excel file is saved and which Excel worksheet we want to use."),(0,o.kt)("p",null,"The steps ",(0,o.kt)("em",{parentName:"p"},"Promoted Headers")," and ",(0,o.kt)("em",{parentName:"p"},"Changed Type")," are also generated automatically and it is an attempt of Power BI to identify table headers and set the columns to each appropriate data type. However, we can already see that there is a problem with the column headers as they are actually on row 3 in the Excel worksheet. Therefore, let's delete the last two steps and start from there."),(0,o.kt)("h4",{id:"2-delete-the-automatically-generated-steps-promoted-headers-and-changed-type"},"2. Delete the automatically generated steps ",(0,o.kt)("em",{parentName:"h4"},"Promoted Headers")," and ",(0,o.kt)("em",{parentName:"h4"},"Changed Type")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-5",src:a(9514).Z,width:"1175",height:"717"})),(0,o.kt)("h4",{id:"3-remove-the-first-two-rows-before-promoting-the-header-row"},"3. Remove the first two rows before promoting the header row"),(0,o.kt)("p",null,"As we have noted, in the data table, actual column headers are in row number 3. Therefore, we first remove the first two rows and then we promote the resulting top row to become our table headers."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Home \u2192 Remove Rows \u2192 Remove Top Rows")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-6",src:a(3087).Z,width:"1316",height:"400"})),(0,o.kt)("p",null,"In the appearing window, enter ",(0,o.kt)("strong",{parentName:"p"},"2")," and confirm with ",(0,o.kt)("em",{parentName:"p"},"OK"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-7",src:a(5292).Z,width:"1174",height:"291"})),(0,o.kt)("p",null,"You can now see on the right that an additional step has been generated called ",(0,o.kt)("em",{parentName:"p"},"Removed Top Rows"),"."),(0,o.kt)("p",null,"Now, promote the top row to become the table headers:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-8",src:a(6571).Z,width:"1321",height:"438"})),(0,o.kt)("p",null,"You should now see the correct column headers and an additional step has been recorded."),(0,o.kt)("p",null,"Please delete the automatically created step ",(0,o.kt)("em",{parentName:"p"},"Changed Type"),"."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"By clicking on the individual steps in ",(0,o.kt)("em",{parentName:"p"},"APPLIED STEPS"),", you can see intermediate results in the data transformation process. Further, note that newly added steps are always put directly after the currently selected step. Steps can be dragged-and-dropped to change the order, however this may lead to errors when steps depend on each other.")),(0,o.kt)("h4",{id:"4-select-the-columns-needed"},"4. Select the columns needed"),(0,o.kt)("p",null,"An important step in each ETL process is the selection of the columns that are needed."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Home \u2192 Choose Columns")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-9",src:a(7422).Z,width:"1317",height:"435"})),(0,o.kt)("p",null,"Select the columns ",(0,o.kt)("em",{parentName:"p"},"Customer ID"),", ",(0,o.kt)("em",{parentName:"p"},"Customer Desc"),", ",(0,o.kt)("em",{parentName:"p"},"Region"),", ",(0,o.kt)("em",{parentName:"p"},"Country")," and ",(0,o.kt)("em",{parentName:"p"},"Segment"),". Note, often when we work with Excel as a data source there are additional columns loaded which are empty and not needed (here ",(0,o.kt)("em",{parentName:"p"},"Column6"),", ",(0,o.kt)("em",{parentName:"p"},"Column7")," etc.)"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-10",src:a(8264).Z,width:"1305",height:"727"})),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Alternatively"),", hold the ",(0,o.kt)("em",{parentName:"p"},"CTRL")," key on your keyboard and select with your mouse all the columns. Then do a right-click into one of the column headers and select ",(0,o.kt)("em",{parentName:"p"},"Remove Other Columns"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-11",src:a(3531).Z,width:"1317",height:"564"})),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"There are many features and options available via ",(0,o.kt)("strong",{parentName:"p"},"right-click on a column header"),".")),(0,o.kt)("h4",{id:"5-set-the-data-type-for-each-column"},"5. Set the data type for each column"),(0,o.kt)("p",null,"As I have outlined in ",(0,o.kt)("a",{parentName:"p",href:"/2.3#223--using-the-right-data-types-for-table-columns"},(0,o.kt)("ins",null,"chapter VERWEIS"))," it is important to define the data type for each column. To do that, we click on the symbol in each table header and select the data type."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-12",src:a(6605).Z,width:"1322",height:"643"})),(0,o.kt)("p",null,"As noted in ",(0,o.kt)("a",{parentName:"p",href:"/2.3#223--using-the-right-data-types-for-table-columns"},(0,o.kt)("ins",null,"chapter VERWEIS"))," we want to convert all table columns to either text, date or numbers. Because we neither have dates nor do we have numerical data with which we want to perform calculations, we define all columns of ",(0,o.kt)("em",{parentName:"p"},"dimCustomer")," to be of the type text (i.e. string in more technical terms)."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Alternatively"),", select all columns of the same type, do a right-click and change the data type for all selected columns at once."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-13",src:a(898).Z,width:"1323",height:"792"})),(0,o.kt)("p",null,"As you can note, there was only one transformation step recorded ",(0,o.kt)("em",{parentName:"p"},"Changed Type")," although we changed the data type of multiple columns."),(0,o.kt)("h4",{id:"6-capitalize-all-words-in-column-segment"},"6. Capitalize all words in column ",(0,o.kt)("em",{parentName:"h4"},"Segment")),(0,o.kt)("p",null,"Looking at the column ",(0,o.kt)("em",{parentName:"p"},"Segment"),", we can see that all words start with lowercase letters. We can improve that with just a right-click on the column header and then follow ",(0,o.kt)("em",{parentName:"p"},"Transform \u2192 Capitalize Each Word"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-14",src:a(117).Z,width:"1319",height:"793"})),(0,o.kt)("h4",{id:"7-replace-values-in-column-country"},"7. Replace values in column ",(0,o.kt)("em",{parentName:"h4"},"Country")),(0,o.kt)("p",null,'Let\'s assume we are not happy with just the ISO code "CH" in column Country and we want to replace it with "Switzerland" instead. Again, just a few clicks are needed to record this transformation step:'),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-15",src:a(2273).Z,width:"1322",height:"796"})),(0,o.kt)("h4",{id:"8-combine-customer-id-and-customer-desc-in-a-new-custom-calculated-column"},"8. Combine ",(0,o.kt)("em",{parentName:"h4"},"Customer ID")," and ",(0,o.kt)("em",{parentName:"h4"},"Customer Desc")," in a new custom calculated column"),(0,o.kt)("p",null,"It is often useful to combine the ID and label of an entity in a dimension table in new field. This is helpful as it allows a user to search for both the label and ID in a filter selector."),(0,o.kt)("p",null,"To do that, we create a new custom calculated column with an easy syntax:"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Add Column \u2192 Custom Column")),(0,o.kt)("p",null,"In the appearing window, name the new column ",(0,o.kt)("em",{parentName:"p"},"Customer")," and enter the following code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="New calculated column: Customer"',title:'"New',calculated:!0,"column:":!0,'Customer"':!0},'[Customer Desc] & " (" & [Customer ID] & ")"\n')),(0,o.kt)("p",null,"The code used is fairly straight forward: we simply combine (or chain) two columns of type text using the &-symbol and some brackets to put the ID in after the Customer label."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-16",src:a(5649).Z,width:"1323",height:"660"})),(0,o.kt)("p",null,"After hitting OK, you can see the newly added column in the preview table. We also need to set the data type of the new column which will be text again. When doing so, you can see that a new step named ",(0,o.kt)("em",{parentName:"p"},"Changed Type1"),' has been created. Power Query automatically added a "1" in the step\'s label because each transformation step has to have a unique label.'),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"You can change the label of a transformation step in ",(0,o.kt)("em",{parentName:"p"},"APPLIED STEPS")," with simply double-clicking on the step and renaming it. It is helpful to rename steps with meaningful labels so other people also working on the model have it easier to have an overview of the transformation steps applied.")),(0,o.kt)("h4",{id:"9-final-step-remove-duplicates-in-column-customer-id"},"9. Final step: Remove duplicates in column ",(0,o.kt)("em",{parentName:"h4"},"Customer ID")),(0,o.kt)("p",null,"Upon careful inspection of the data, we can actually see that there are duplicate entries for the customers with ID 23 and 37:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-17",src:a(203).Z,width:"1323",height:"874"})),(0,o.kt)("p",null,"This is a typical ",(0,o.kt)("strong",{parentName:"p"},"data quality issue")," often occuring in practice, in particular when working with data sources like text or spreadsheet files."),(0,o.kt)("p",null,"Given that the column ",(0,o.kt)("em",{parentName:"p"},"Customer ID")," shall be the ",(0,o.kt)("strong",{parentName:"p"},"primary key")," column of ",(0,o.kt)("em",{parentName:"p"},"dimCustomer"),", we need to make sure that all values in ",(0,o.kt)("em",{parentName:"p"},"Customer ID")," are unique and there are no duplicates. Simply do a right-click on ",(0,o.kt)("em",{parentName:"p"},"Customer ID")," and click on ",(0,o.kt)("em",{parentName:"p"},"Remove Duplicates"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"03-18",src:a(2919).Z,width:"1321",height:"784"})),(0,o.kt)("p",null,"Please note, in a real-world application you would of course want to make sure that these issues are fixed at the data source level and not in Power Query."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"In order to quickly check a column for duplicate entries, select the column and do the following: ",(0,o.kt)("em",{parentName:"p"},"Home \u2192 Keep Rows \u2192 Keep Duplicates"),". The table preview will only return duplicate rows.")),(0,o.kt)("p",null,"Now our table ",(0,o.kt)("em",{parentName:"p"},"dimCustomer")," is ready to be used in the data model."))}c.isMDXComponent=!0},8264:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-10-039055c6a81dda5a801ed6198833bca5.png"},3531:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-11-210da6e886e45945291dc2de0f4985f6.png"},6605:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-12-b8cfa8b5f8549c73001c0031852b77d0.png"},898:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-13-edda99a7918c2446b9d9425f67a1354b.png"},117:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-14-e041e77f39bfa3f0ffa683b8e7b3f0b9.png"},2273:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-15-fa47aea783cc81c7530b8fc4f061cee3.png"},5649:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-16-6e3e69776f185baf2954908e61c98641.png"},203:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-17-fbfcdc8d8c62a358049316d724e3d144.png"},2919:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-18-cd0641077a3a49964fdb4e97b7003da5.png"},6477:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-4-ea2c295e8aff384d85ab801f8dfd248f.png"},9514:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-5-3172c374a7b71116380596022cf22f80.png"},3087:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-6-68560c50544e745fce96327e7834a9c5.png"},5292:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-7-cb7b502aa9e624936a877738ce73952a.png"},6571:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-8-2410e246dc8d17feb9a3479ac4399e3b.png"},7422:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-9-f9f022b5cc74c19ba4b207d68e76abac.png"}}]);