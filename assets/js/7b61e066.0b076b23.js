"use strict";(self.webpackChunkdata_and_analytics=self.webpackChunkdata_and_analytics||[]).push([[3980],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=d(a),h=r,u=p["".concat(s,".").concat(h)]||p[h]||m[h]||o;return a?n.createElement(u,l(l({ref:t},c),{},{components:a})):n.createElement(u,l({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=h;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[p]="string"==typeof e?e:r,l[1]=i;for(var d=2;d<o;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},2817:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var n=a(7462),r=(a(7294),a(3905));const o={sidebar_position:999,title:"3.6 | Preparing the date dimension (dimDate)",slug:"/3.6",tags:["3 | Preparing the data"]},l="3.6 | Preparing the date dimension (*dimDate*)",i={unversionedId:"book/chapter3/03-06-prepare-4",id:"book/chapter3/03-06-prepare-4",title:"3.6 | Preparing the date dimension (dimDate)",description:"The final dimension table to be prepared is one that is likely shared among nearly all existing business intelligence solutions worldwide: the date dimension.",source:"@site/docs/01-book/01-chapter3/03-06-prepare-4.md",sourceDirName:"01-book/01-chapter3",slug:"/3.6",permalink:"/3.6",draft:!1,tags:[{label:"3 | Preparing the data",permalink:"/tags/3-preparing-the-data"}],version:"current",sidebarPosition:999,frontMatter:{sidebar_position:999,title:"3.6 | Preparing the date dimension (dimDate)",slug:"/3.6",tags:["3 | Preparing the data"]},sidebar:"tutorialSidebar",previous:{title:"3.5 | Preparing the sales channel dimension (dimSalesChannel)",permalink:"/3.5"},next:{title:"4 | Creating the data model",permalink:"/category/4--creating-the-data-model"}},s={},d=[{value:"1. Create a new <em>Blank Query</em>",id:"1-create-a-new-blank-query",level:4},{value:"2. Open the <em>Advanced Editor</em> for the newly created <em>Blank Query</em>",id:"2-open-the-advanced-editor-for-the-newly-created-blank-query",level:4},{value:"3. Copy and paste the template script into the Advanced Editor window",id:"3-copy-and-paste-the-template-script-into-the-advanced-editor-window",level:4},{value:"4. Enter the parameters and generate the calendar table",id:"4-enter-the-parameters-and-generate-the-calendar-table",level:4},{value:"5. Inspect and rename the newly created calendar table",id:"5-inspect-and-rename-the-newly-created-calendar-table",level:4}],c={toc:d};function p(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,n.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"36--preparing-the-date-dimension-dimdate"},"3.6 | Preparing the date dimension (",(0,r.kt)("em",{parentName:"h1"},"dimDate"),")"),(0,r.kt)("p",null,"The final dimension table to be prepared is one that is likely shared among nearly all existing business intelligence solutions worldwide: the date dimension."),(0,r.kt)("p",null,"The date dimension ",(0,r.kt)("em",{parentName:"p"},"dimDate")," is basically a calendar table with which we can filter, slice and aggregate fact data over the time dimension. In our use-case we will work with dates only as timestamps are not relevant for us."),(0,r.kt)("p",null,"There are different ways to create a date dimension Power BI. We will use a ",(0,r.kt)("strong",{parentName:"p"},"template script")," with which we can create a date dimension with just a few clicks."),(0,r.kt)("h4",{id:"1-create-a-new-blank-query"},"1. Create a new ",(0,r.kt)("em",{parentName:"h4"},"Blank Query")),(0,r.kt)("p",null,"To use the template script, first we have to create an empty query as follows:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"03-35",src:a(4910).Z,width:"1321",height:"594"})),(0,r.kt)("h4",{id:"2-open-the-advanced-editor-for-the-newly-created-blank-query"},"2. Open the ",(0,r.kt)("em",{parentName:"h4"},"Advanced Editor")," for the newly created ",(0,r.kt)("em",{parentName:"h4"},"Blank Query")),(0,r.kt)("p",null,"Make sure you have selected the newly created query ",(0,r.kt)("em",{parentName:"p"},"Query1")," and then click on ",(0,r.kt)("em",{parentName:"p"},"Advanced Editor")," under ",(0,r.kt)("em",{parentName:"p"},"Home"),":"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"03-36",src:a(6619).Z,width:"1322",height:"446"})),(0,r.kt)("h4",{id:"3-copy-and-paste-the-template-script-into-the-advanced-editor-window"},"3. Copy and paste the template script into the Advanced Editor window"),(0,r.kt)("p",null,"In the appearing window, first delete everything and the copy and paste the code below and confirm with ",(0,r.kt)("em",{parentName:"p"},"Done"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="Template script: dimDate"',title:'"Template',"script:":!0,'dimDate"':!0},'let GenerateDateTable = (vStart as date, vEnd as date, vFiscalYearEnd as text, optional vLanguage as nullable text) as table =>\nlet\n\xa0\xa0\xa0\xa0DayCount = Duration.Days(Duration.From(vEnd - vStart))+1,\n\xa0\xa0\xa0\xa0Source = List.Dates(vStart,DayCount,#duration(1,0,0,0)),\n\xa0\xa0\xa0\xa0TableFromList = Table.FromList(Source, Splitter.SplitByNothing()),\n\xa0\xa0\xa0\xa0ChangedType = Table.TransformColumnTypes(TableFromList,{{"Column1", type date}}),\n\xa0\xa0\xa0\xa0RenamedColumns = Table.RenameColumns(ChangedType,{{"Column1", "Date"}}),\n\xa0\xa0\xa0\xa0InsertYear = Table.AddColumn(RenamedColumns, "Year", each Date.Year([Date]), Int64.Type),\n\xa0\xa0\xa0\xa0InsertQuarterNo = Table.AddColumn(InsertYear, "QuarterNo", each Date.QuarterOfYear([Date]), Int64.Type),\n    InsertQuarterDesc = Table.AddColumn(InsertQuarterNo, "QuarterDesc", each "Q"&Text.From([QuarterNo]), type text),\n\xa0\xa0\xa0\xa0InsertMonthNo = Table.AddColumn(InsertQuarterDesc, "MonthNo", each Date.Month([Date]), Int64.Type),\n\xa0\xa0\xa0\xa0InsertDayNo = Table.AddColumn(InsertMonthNo, "DayNo", each Date.Day([Date]), Int64.Type),\n    InsertDayDesc = Table.AddColumn(InsertDayNo, "DayDesc", each Date.ToText([Date], "dddd", vLanguage), type text),\n\xa0\xa0\xa0\xa0InsertDayInt = Table.AddColumn(InsertDayDesc, "DateInt", each [Year] * 10000 + [MonthNo] * 100 + [DayNo], Int64.Type),\n\xa0\xa0\xa0\xa0InsertMonthDesc = Table.AddColumn(InsertDayInt, "MonthDesc", each Date.ToText([Date], "MMMM", vLanguage), type text),\n    InsertMonthDescShort = Table.AddColumn(InsertMonthDesc, "MonthDescShort", each Text.Start([MonthDesc], 3), type text),\n\xa0\xa0\xa0\xa0InsertMonthAndYear = Table.AddColumn(InsertMonthDescShort, "MonthAndYear", each (try(Text.Range([MonthDesc],0,3)) otherwise [MonthDesc]) & " " & Number.ToText([Year]), type text),\n\xa0\xa0\xa0\xa0InsertQuarterAndYear = Table.AddColumn(InsertMonthAndYear, "QuarterAndYear", each "Q" & Number.ToText([QuarterNo]) & " " & Number.ToText([Year]), type text),\n\xa0\xa0\xa0\xa0InsertDayInWeekNo = Table.AddColumn(InsertQuarterAndYear, "DayInWeekNo", each Date.DayOfWeek([Date]), Int64.Type),\n\xa0\xa0\xa0\xa0InsertWeekEnding = Table.AddColumn(InsertDayInWeekNo, "WeekEnding", each Date.EndOfWeek([Date]), type date),\n    InsertEndOfFiscalYear = Table.AddColumn(InsertWeekEnding, "EndOfFiscalYear", each Date.From(vFiscalYearEnd&Text.From([Year])), type date),\n    InsertHelper = Table.AddColumn(InsertEndOfFiscalYear, "helper", each if [Date]<=[EndOfFiscalYear] then 1 else 0, Int64.Type),\n    InsertFiscalYearDesc = Table.AddColumn(InsertHelper, "FiscalYearDesc", each if [helper] = 1 then Text.From([Year]-1)&"/"&Text.End (Text.From([Year]),2) else Text.From([Year])&"/"&Text.End (Text.From([Year]+1),2), type text),\n    InsertMonthOfFiscalYear = Table.AddColumn(InsertFiscalYearDesc, "MonthOfFiscalYear", each if [helper] = 1 then 12+[MonthNo]-Date.Month([EndOfFiscalYear]) else [MonthNo]-Date.Month([EndOfFiscalYear]), type number),\n    InsertQuarterOfFiscalYear = Table.AddColumn(InsertMonthOfFiscalYear, "QuarterOfFiscalYear", each if [MonthOfFiscalYear] >=1 and [MonthOfFiscalYear] <=3 then 1 else (if [MonthOfFiscalYear] >=4 and [MonthOfFiscalYear] <=6 then 2 else (if [MonthOfFiscalYear] >=7 and [MonthOfFiscalYear] <=9 then 3 else (if [MonthOfFiscalYear] >=10 and [MonthOfFiscalYear] <=12 then 4 else 0))), type number),\n    InsertFiscalQuarterDesc = Table.AddColumn(InsertQuarterOfFiscalYear, "FiscalQuarterDesc", each "Q"&Text.From([QuarterOfFiscalYear]), type text),\n    InsertEndOfMonth = Table.AddColumn(InsertFiscalQuarterDesc, "EndOfMonthDate", each Date.EndOfMonth([Date]), type date),\n    InsertDayOfYear = Table.AddColumn(InsertEndOfMonth, "DayOfYear", each Date.DayOfYear([Date]), Int64.Type),\n    #"Removed Columns" = Table.RemoveColumns(InsertDayOfYear,{"helper"}), Deletunneeded = if vFiscalYearEnd = "31.12." then Table.RemoveColumns(#"Removed Columns",{"FiscalYearDesc", "MonthOfFiscalYear", "QuarterOfFiscalYear", "FiscalQuarterDesc"}) else #"Removed Columns"\nin\n    #"Removed Columns"\nin\n\xa0\xa0  GenerateDateTable\n')),(0,r.kt)("h4",{id:"4-enter-the-parameters-and-generate-the-calendar-table"},"4. Enter the parameters and generate the calendar table"),(0,r.kt)("p",null,"After confirming with Done enter the following values as the parameters to create the calendar table:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"03-37",src:a(7811).Z,width:"1324",height:"620"})),(0,r.kt)("p",null,"The parameters ",(0,r.kt)("em",{parentName:"p"},"vStart")," and ",(0,r.kt)("em",{parentName:"p"},"vEnd")," are the dates from when the calendar should start and end respectively. The parameter ",(0,r.kt)("em",{parentName:"p"},"vFiscalYearEnd")," defines as of when the fiscal year ends. With ",(0,r.kt)("em",{parentName:"p"},"vLanguage")," (which can also be left empty) we can define the language used to generate some of the fields, for example month names."),(0,r.kt)("p",null,"After entering the values as in the screenshot, confirm with ",(0,r.kt)("em",{parentName:"p"},"Invoke")," to generate the calendar table."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Depending on the current language settings in your Power BI file, you might need to enter the date parameters in another format. Navigate to the Power BI options via ",(0,r.kt)("em",{parentName:"p"},"File")," \u2192 ",(0,r.kt)("em",{parentName:"p"},"Options")," \u2192 ",(0,r.kt)("em",{parentName:"p"},"CURRENT FILE")," \u2192 ",(0,r.kt)("em",{parentName:"p"},"Regional Settings"),' to see your current settings. In the example here, the settings are on "German (Switzerland)".')),(0,r.kt)("h4",{id:"5-inspect-and-rename-the-newly-created-calendar-table"},"5. Inspect and rename the newly created calendar table"),(0,r.kt)("p",null,"Power Query has no created a new table ",(0,r.kt)("em",{parentName:"p"},"Invoked Function"),". Navigate to that table and have a look at it. As you can see there is a column ",(0,r.kt)("em",{parentName:"p"},"Date")," that contains one row for each date between ",(0,r.kt)("em",{parentName:"p"},"vStart")," and ",(0,r.kt)("em",{parentName:"p"},"vEnd"),". Further, there are many additional columns that are useful for the analysis and report building later."),(0,r.kt)("p",null,"Please note, we do not need to do any transformations to the created calendar table as the script takes care of that for us. However, it is always possible to add additional transformation steps if needed. So you can always combine the template script with some additional columns etc. as needed."),(0,r.kt)("p",null,"Rename the table to ",(0,r.kt)("em",{parentName:"p"},"dimDate")," via double-clicking on the table in the ",(0,r.kt)("em",{parentName:"p"},"Queries")," navigation (alternatively, do a right-click and select Rename)."),(0,r.kt)("p",null,"For better clarity, also rename the function we used to ",(0,r.kt)("em",{parentName:"p"},"Generate date table"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"03-38",src:a(8817).Z,width:"1319",height:"485"})))}p.isMDXComponent=!0},4910:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-35-99d542e9e7b20359a82bf55a5754e13e.png"},6619:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-36-4e77883ddf2e905ffe7b27096d927b29.png"},7811:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-37-5d802c20a97e4dd0947d8b2ff723b011.png"},8817:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/img_book_03-38-462ce56e81547ef55d84a92d3a5d6a44.png"}}]);