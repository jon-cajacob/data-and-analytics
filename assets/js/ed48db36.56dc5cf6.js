"use strict";(self.webpackChunkdata_and_analytics=self.webpackChunkdata_and_analytics||[]).push([[7025],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>d});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),u=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),m=u(a),h=n,d=m["".concat(l,".").concat(h)]||m[h]||p[h]||s;return a?r.createElement(d,i(i({ref:t},c),{},{components:a})):r.createElement(d,i({ref:t},c))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,i=new Array(s);i[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[m]="string"==typeof e?e:n,i[1]=o;for(var u=2;u<s;u++)i[u]=a[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},61713:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>u});var r=a(87462),n=(a(67294),a(3905));const s={sidebar_position:4,title:"5.4 | Creating and configuring the first measures",slug:"/5.4",tags:["tag1"]},i="5.4 | Creating and configuring the first measures",o={unversionedId:"book/chapter5/05-04-first-measures",id:"book/chapter5/05-04-first-measures",title:"5.4 | Creating and configuring the first measures",description:"In this chapter, we will create the first measures using DAX. First, I will explain how the code for a measure is structured. Following that, we will create four basic measures which I use in almost every BI solution in practice.",source:"@site/docs/01-book/01-chapter5/05-04-first-measures.md",sourceDirName:"01-book/01-chapter5",slug:"/5.4",permalink:"/5.4",draft:!1,tags:[{label:"tag1",permalink:"/tags/tag-1"}],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"5.4 | Creating and configuring the first measures",slug:"/5.4",tags:["tag1"]},sidebar:"tutorialSidebar",previous:{title:"5.3 | Working with and applying filters",permalink:"/5.3"},next:{title:"5.5 | Commonly used DAX measure patterns using CALCULATE()",permalink:"/5.5"}},l={},u=[{value:"5.4.1 | How a measure is defined with DAX",id:"541--how-a-measure-is-defined-with-dax",level:2},{value:"5.4.2 | Basic measure for sales in USD",id:"542--basic-measure-for-sales-in-usd",level:2},{value:"5.4.3 | Measure for previous year sales in USD",id:"543--measure-for-previous-year-sales-in-usd",level:2},{value:"5.4.4 | Measure for year-over-year variance in sales in USD",id:"544--measure-for-year-over-year-variance-in-sales-in-usd",level:2},{value:"5.4.5 | Chapter conclusion",id:"545--chapter-conclusion",level:2}],c={toc:u};function m(e){let{components:t,...s}=e;return(0,n.kt)("wrapper",(0,r.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"54--creating-and-configuring-the-first-measures"},"5.4 | Creating and configuring the first measures"),(0,n.kt)("p",null,"In this chapter, we will create the first measures using ",(0,n.kt)("strong",{parentName:"p"},"DAX"),". First, I will explain how the code for a measure is structured. Following that, we will create four basic measures which I use in almost every BI solution in practice."),(0,n.kt)("p",null,"Remember, measures are ",(0,n.kt)("strong",{parentName:"p"},"dynamic")," custom calculations which means they are immediately re-calculated as soon as for example the filter context on a given report changes. This is opposed to ",(0,n.kt)("strong",{parentName:"p"},"static")," custom calculated columns created in Power Query, which are only updated when the dataset is refreshed."),(0,n.kt)("h2",{id:"541--how-a-measure-is-defined-with-dax"},"5.4.1 | How a measure is defined with DAX"),(0,n.kt)("p",null,"The following illustration shows how a measure is structurally written with DAX. The first example is a very simple measure, though quite important in many real-world use-cases. The second example shows how we can use variables and also reference other measures inside a new measure."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-88",src:a(4639).Z,width:"1307",height:"833"})),(0,n.kt)("p",null,"Note how in the second example, first a variable (",(0,n.kt)("em",{parentName:"p"},"vSalesCY"),") is created that simply references another measure without further manipulation. The second variable (",(0,n.kt)("em",{parentName:"p"},"vSalesPY"),") also references the same measure, however its filter context is manipulated with CALCULATE() (see chapter VERWEIS). Finally, the variable ",(0,n.kt)("em",{parentName:"p"},"vResult")," is defined as the variation between the first two variables and it is returned as the result for the measure (after ",(0,n.kt)("em",{parentName:"p"},"RETURN"),")."),(0,n.kt)("p",null,"Don't worry if that seems a little overwhelming at this point. We will now create the measures step-by-step and it should become more clear accordingly."),(0,n.kt)("h2",{id:"542--basic-measure-for-sales-in-usd"},"5.4.2 | Basic measure for sales in USD"),(0,n.kt)("p",null,"To create a new measure, do a right-click on the table ",(0,n.kt)("em",{parentName:"p"},"_Measures")," and select ",(0,n.kt)("em",{parentName:"p"},"New measure"),". Note, each Measure has a home table where it is stored. Like described in chapter VERWEIS, it is good practice to have a separate table in the Power BI data model specifically for storing and organizing measures."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-80",src:a(32975).Z,width:"1325",height:"864"})),(0,n.kt)("p",null,"When creating a new measure, the formula bar appears and we can enter the measure name followed by the DAX code."),(0,n.kt)("p",null,"The measure we want to create is defined as following:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="New measure: Sales in USD"',title:'"New',"measure:":!0,Sales:!0,in:!0,'USD"':!0},"Sales in USD = SUM( factSales[Sales in USD] )\n")),(0,n.kt)("p",null,"When you start typing after the equal sign, you will notice how Power BI gives you recommendations for functions, tables and fields to be used. This is called ",(0,n.kt)("em",{parentName:"p"},"IntelliSense"),"."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-81",src:a(26859).Z,width:"1324",height:"570"})),(0,n.kt)("p",null,"When finishing typing the formula, confirm via the checkmark symbol. The new measure should appear under the ",(0,n.kt)("em",{parentName:"p"},"_Measure")," table:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-82",src:a(1137).Z,width:"1323",height:"570"})),(0,n.kt)("p",null,"Before we use the measure for visualizations, let's make sure the ",(0,n.kt)("strong",{parentName:"p"},"number format")," is correct. When having selected the measure in the table navigation, you can change the formatting options in the main navigation pane. Let's format the new measure as a \"Whole Number\" with thousand's separators activated:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-83",src:a(30988).Z,width:"1323",height:"570"})),(0,n.kt)("p",null,"Now we can use the measure in a visualization, just like we did it in the previous chapter:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-84",src:a(22845).Z,width:"1323",height:"858"})),(0,n.kt)("h2",{id:"543--measure-for-previous-year-sales-in-usd"},"5.4.3 | Measure for previous year sales in USD"),(0,n.kt)("p",null,"The next measure follows a very commonly used pattern for time / date calculations. What we want to achieve is to manipulate the filter context inside the measure so we always get the previous year value for sales from the perspective of a currently selected year."),(0,n.kt)("p",null,"Let's create another measure as following:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="New measure: Sales in USD PY"',title:'"New',"measure:":!0,Sales:!0,in:!0,USD:!0,'PY"':!0},"Sales in USD PY =\nCALCULATE ( [Sales in USD], DATEADD ( dimDate[Date], -1, YEAR ) )\n")),(0,n.kt)("p",null,"Note how we reference the previously created measure ",(0,n.kt)("em",{parentName:"p"},"[Sales in USD]")," inside the new measure."),(0,n.kt)("p",null,"Then, create a new report page and place an empty matrix visual on the canvas. Populate the matrix with the measures ",(0,n.kt)("em",{parentName:"p"},"[Sales in USD]")," and ",(0,n.kt)("em",{parentName:"p"},"[Sales in USD PY]")," and with ",(0,n.kt)("em",{parentName:"p"},"Year")," from ",(0,n.kt)("em",{parentName:"p"},"dimDate")," as the rows."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-85",src:a(96690).Z,width:"1318",height:"856"})),(0,n.kt)("p",null,"Now let's take a moment to understand what is going on. The filter context, given by the rows in the matrix visual is ",(0,n.kt)("em",{parentName:"p"},"Year")," from ",(0,n.kt)("em",{parentName:"p"},"dimDate"),". The measure ",(0,n.kt)("em",{parentName:"p"},"[Sales in USD]")," shows the sales amount for each year. The measure ",(0,n.kt)("em",{parentName:"p"},"[Sales in USD PY]"),' on the other hand always shows exactly the value of the previous year. The filter context is basically manipulated to move the timeline back by one year, hence the "-1" and "YEAR" parameters in the DATEADD() function inside the measure. Working with dates and times in measures uses the framework of ',(0,n.kt)("em",{parentName:"p"},"Time Intelligence")," in Power BI. This is the reason why we had to mark the table dimDate as a date table previously."),(0,n.kt)("p",null,"We will discuss the function CALCULATE() in more detail later given its relevance in practice."),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"The DAX function CALCULATE() is maybe the most important function used to create measures. It allows to specifically manipulate the filter context for a calculation. There are a lot of articles, guides and videos available on the Internet focused on this very function.")),(0,n.kt)("h2",{id:"544--measure-for-year-over-year-variance-in-sales-in-usd"},"5.4.4 | Measure for year-over-year variance in sales in USD"),(0,n.kt)("p",null,"Now that we have sales for the current and previous year defined in two measures, we easily create another measure that calculates the difference between the two using a simple substraction:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="New measure: Sales in USD \u0394PY"',title:'"New',"measure:":!0,Sales:!0,in:!0,USD:!0,'\u0394PY"':!0},"Sales in USD \u0394PY =\n[Sales in USD] - [Sales in USD PY]\n")),(0,n.kt)("p",null,"Let's consider that in many real-world use-cases, the year-over-year variance is also needed in percentage:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="New measure: Sales in USD \u0394%PY"',title:'"New',"measure:":!0,Sales:!0,in:!0,USD:!0,'\u0394%PY"':!0},"Sales in USD \u0394%PY =\nDIVIDE( [Sales in USD] - [Sales in USD PY], [Sales in USD PY])\n")),(0,n.kt)("p",null,'We use the DIVIDE() function instead of just "/" because the former handles division by zero better.'),(0,n.kt)("p",null,"Make sure the formatting of both new measures is set appropriately and then place them in the matrix visualization we added previously:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-87",src:a(4224).Z,width:"1321",height:"751"})),(0,n.kt)("p",null,"In this way, we can create very powerful reporting tables with drill hiearchies that are fully dynamic. Imagine the manual effort required to perform this calculation for example in an Excel spreadsheet."),(0,n.kt)("h2",{id:"545--chapter-conclusion"},"5.4.5 | Chapter conclusion"),(0,n.kt)("p",null,"We now created our first four measures with using quite simple DAX code. These four measures though are very powerful and they represent the base set of measures for most Power BI solutions in my own practice."),(0,n.kt)("p",null,"In the next chapter, we will work with the all important DAX function CALCULATE() to manipulate the filter context inside a measure."))}m.isMDXComponent=!0},32975:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-80-2dba90421d66d3d422d31f8cda8b3952.png"},26859:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-81-e9ee25a44e0c2a8015854c617ac8836e.png"},1137:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-82-223153acce4bdb55781032d2db8226e5.png"},30988:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-83-21eec19191bcf2f12fbbaf2e2bad4e2e.png"},22845:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-84-fb848ad54802290b0b831e8012937c14.png"},96690:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-85-47cc681dc8e90636c5e3034a2d21136a.png"},4224:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-87-e956dcb4623555a5d945a2aad73c6206.png"},4639:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/img_book_03-88-9f02cb0f6b5a243ec50f6aa2413a51fd.png"}}]);