"use strict";(self.webpackChunkdata_and_analytics=self.webpackChunkdata_and_analytics||[]).push([[7271],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>p});var l=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,l,n=function(e,t){if(null==e)return{};var a,l,n={},r=Object.keys(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)a=r[l],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=l.createContext({}),c=function(e){var t=l.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=c(e.components);return l.createElement(s.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},m=l.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=c(a),m=n,p=d["".concat(s,".").concat(m)]||d[m]||h[m]||r;return a?l.createElement(p,i(i({ref:t},u),{},{components:a})):l.createElement(p,i({ref:t},u))}));function p(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[d]="string"==typeof e?e:n,i[1]=o;for(var c=2;c<r;c++)i[c]=a[c];return l.createElement.apply(null,i)}return l.createElement.apply(null,a)}m.displayName="MDXCreateElement"},269:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var l=a(7462),n=(a(7294),a(3905));const r={sidebar_position:8,title:"5.8 | Creating a calculated table with DAX",slug:"/5.8",tags:["DAX","Calculated table","Calculated column","DAX table functions"]},i="5.8 | Creating a calculated table with DAX",o={unversionedId:"book/chapter5/05-08-calc-table",id:"book/chapter5/05-08-calc-table",title:"5.8 | Creating a calculated table with DAX",description:"For a measure to work properly, the DAX code used must return a single value. But there are also DAX functions that return entire tables. Given that, we can create calculated tables using DAX that are part of the data model. In this short chapter, I want to show how this is done using different DAX table functions.",source:"@site/docs/01-book/01-chapter5/05-08-calc-table.md",sourceDirName:"01-book/01-chapter5",slug:"/5.8",permalink:"/5.8",draft:!1,tags:[{label:"DAX",permalink:"/tags/dax"},{label:"Calculated table",permalink:"/tags/calculated-table"},{label:"Calculated column",permalink:"/tags/calculated-column"},{label:"DAX table functions",permalink:"/tags/dax-table-functions"}],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8,title:"5.8 | Creating a calculated table with DAX",slug:"/5.8",tags:["DAX","Calculated table","Calculated column","DAX table functions"]},sidebar:"tutorialSidebar",previous:{title:"5.7 | Example of a fully functioning dashboard",permalink:"/5.7"},next:{title:"6 | Publishing and sharing datasets and reports (Power BI Service)",permalink:"/category/6--publishing-and-sharing-datasets-and-reports-power-bi-service"}},s={},c=[{value:"5.8.1 | Creating a new calculated table",id:"581--creating-a-new-calculated-table",level:2},{value:"5.8.2 | Addding a calculated column to an existing table",id:"582--addding-a-calculated-column-to-an-existing-table",level:2},{value:"5.8.3 | Using the calculated table and columns in the report",id:"583--using-the-calculated-table-and-columns-in-the-report",level:2},{value:"5.8.4 | When to use calculated tables",id:"584--when-to-use-calculated-tables",level:2}],u={toc:c};function d(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,l.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"58--creating-a-calculated-table-with-dax"},"5.8 | Creating a calculated table with DAX"),(0,n.kt)("p",null,"For a measure to work properly, the DAX code used must return a single value. But there are also DAX functions that return entire tables. Given that, we can create calculated tables using DAX that are part of the data model. In this short chapter, I want to show how this is done using different DAX table functions."),(0,n.kt)("p",null,"A calculated table is stored in the data model and only recalculated when any of the tables it uses data from is refreshed or updated. I like to think of it as tables that are created between Power Query and the report designer."),(0,n.kt)("h2",{id:"581--creating-a-new-calculated-table"},"5.8.1 | Creating a new calculated table"),(0,n.kt)("p",null,"To create a new calculated table, navigate to the ",(0,n.kt)("em",{parentName:"p"},"Data view")," and click on ",(0,n.kt)("em",{parentName:"p"},"New table")," under the ",(0,n.kt)("em",{parentName:"p"},"Table tools")," navigation. In the appearing formula editor, paste the following DAX code and confirm with the checkmark symbol."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="New calculated table: CalcTable1"',title:'"New',calculated:!0,"table:":!0,'CalcTable1"':!0},'CalcTable1 = \nVAR vtbl1 =\n    CALCULATETABLE (\n        SUMMARIZE ( factSales, dimProduct[Category], dimDate[Year] ),\n        dimDate[Year] = 2023 || dimDate[Year] = 2022\n    )\nVAR vtbl2 =\n    ADDCOLUMNS (\n        vtbl1,\n        "Total Sales", CALCULATE ( SUM ( factSales[Sales in USD] ) ),\n        "Total Sales PY", CALCULATE ( SUM ( factSales[Sales in USD] ), DATEADD ( dimDate[Date], -12, MONTH ) )\n    )\nRETURN\n    vtbl2\n')),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-93",src:a(5860).Z,width:"1325",height:"857"})),(0,n.kt)("p",null,"Notice how a new table has appeared in the data navigation. As for the other tables coming from Power Query, we can format fields, create hierarchies, connect them with other tables etc. In the screenshot, you can see that I formated the value fields as whole numbers with thousands separators."),(0,n.kt)("p",null,"Now let's understand what we are doing with the DAX code:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"First, we create a variable ",(0,n.kt)("em",{parentName:"li"},"vtbl1")," that stores an intermediate table that is based on ",(0,n.kt)("em",{parentName:"li"},"factSales")," and basically groups by ",(0,n.kt)("em",{parentName:"li"},"Category")," of ",(0,n.kt)("em",{parentName:"li"},"dimProduct")," and ",(0,n.kt)("em",{parentName:"li"},"Year")," of ",(0,n.kt)("em",{parentName:"li"},"dimDate")," (similar to a GROUPY BY statement in SQL). This intermediate table is also filtered using CALCULATETABLE() by ",(0,n.kt)("em",{parentName:"li"},"Year")," from ",(0,n.kt)("em",{parentName:"li"},"dimDate")),(0,n.kt)("li",{parentName:"ul"},"Second, we use the intermediate table ",(0,n.kt)("em",{parentName:"li"},"vtbl1")," as the basis for another table stored as a variable ",(0,n.kt)("em",{parentName:"li"},"vtbl2")," and we add additional columns that calculate the total sales for the current year and previous year. Note how we have to use CALCULATE(), because otherwise the calculation is not performed on row level"),(0,n.kt)("li",{parentName:"ul"},"Finally, we return the table ",(0,n.kt)("em",{parentName:"li"},"vtbl2")," as the result of the code")),(0,n.kt)("h2",{id:"582--addding-a-calculated-column-to-an-existing-table"},"5.8.2 | Addding a calculated column to an existing table"),(0,n.kt)("p",null,"One this we can also do is to add calculated columns to existing tables in the data model. Note, this applies also to tables that are loaded from Power Query."),(0,n.kt)("p",null,"To add a new calculated column, click on ",(0,n.kt)("em",{parentName:"p"},"New column")," under ",(0,n.kt)("em",{parentName:"p"},"Table tools")," and add the following DAX code:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="New calculated column: Total Sales \u0394PY"',title:'"New',calculated:!0,"column:":!0,Total:!0,Sales:!0,'\u0394PY"':!0},"Total Sales \u0394PY = \nCalcTable1[Total Sales] - CalcTable1[Total Sales PY]\n")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-94",src:a(3688).Z,width:"1321",height:"595"})),(0,n.kt)("p",null,"With this new calculated column, we simple calculate the difference between two already existing columns of the table."),(0,n.kt)("h2",{id:"583--using-the-calculated-table-and-columns-in-the-report"},"5.8.3 | Using the calculated table and columns in the report"),(0,n.kt)("p",null,"Of course, we use the newly created table and its columns in the report designer in the same way as any other table loaded from Power Query."),(0,n.kt)("p",null,"To confirm that the values in the new table are correct, let's compare them with the measures that we created earlier for total sales:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"03-95",src:a(60).Z,width:"1321",height:"735"})),(0,n.kt)("p",null,"With this we can confirm that the values are identical."),(0,n.kt)("h2",{id:"584--when-to-use-calculated-tables"},"5.8.4 | When to use calculated tables"),(0,n.kt)("p",null,"Finally, a few words about use-cases when the use of calculated tables makes sense. In general, you should always try to implement a KPI with a measure, because it is the most dynamic and versatile way of working with custom calculations. Sometimes though, the requirements for a calculation are very complex and require the preparation of intermediate results. In such cases, it may makes sense to work with calculated tables."),(0,n.kt)("p",null,"Note, we can also use DAX table functions inside a measure to create intermediate tables based on which we then perform a specific calculation. The challenge with that is, that the intermediate table is not visible and the DAX formula becomes abstract and hard to interpret. Given that, another good use-case for calculated tables is to use this feature to understand and see intermediate tables with a temporary table. When the measure is then finally working as intended, the temporary calculated table can be deleted again."))}d.isMDXComponent=!0},5860:(e,t,a)=>{a.d(t,{Z:()=>l});const l=a.p+"assets/images/img_book_03-93-85ba9ad69572f184108e3c10b4631dc6.png"},3688:(e,t,a)=>{a.d(t,{Z:()=>l});const l=a.p+"assets/images/img_book_03-94-f324fabdbd14a08ec85f53d6d319bc9f.png"},60:(e,t,a)=>{a.d(t,{Z:()=>l});const l=a.p+"assets/images/img_book_03-95-c45624086b79932528ac8b2944517ae0.png"}}]);