<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-book/chapter3/03-03-prepare-1">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">3.3 | Preparing the customer dimension (dimCustomer) | A Data &amp; Analytics Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.github.com/3.3"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="3.3 | Preparing the customer dimension (dimCustomer) | A Data &amp; Analytics Wiki"><meta data-rh="true" name="description" content="After connecting the Excel file and its data tables, we will now proceed with preparing the individual dimension and fact tables using data transformation steps in Power Query. The first dimension we will prepare is the customer dimension containing respective master data."><meta data-rh="true" property="og:description" content="After connecting the Excel file and its data tables, we will now proceed with preparing the individual dimension and fact tables using data transformation steps in Power Query. The first dimension we will prepare is the customer dimension containing respective master data."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.github.com/3.3"><link data-rh="true" rel="alternate" href="https://www.github.com/3.3" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.github.com/3.3" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="A Data &amp; Analytics Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="A Data &amp; Analytics Wiki Atom Feed"><link rel="stylesheet" href="/assets/css/styles.0e575c3e.css">
<link rel="preload" href="/assets/js/runtime~main.06b1a5a4.js" as="script">
<link rel="preload" href="/assets/js/main.2be230da.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">A Data &amp; Analytics Wiki</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Wiki</a><a class="navbar__item navbar__link" href="/tags">by Tags</a><a class="navbar__item navbar__link" href="/category/business-intelligence--analytics-with-microsoft-power-bi-book-in-progress">BI &amp; Analytics with Power BI Guide</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/blog">Blog</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog">Overview</a></li><li><a class="dropdown__link" href="/blog/tags">All Tags</a></li><li><a class="dropdown__link" href="/blog/tags/project-management">1 | Project Management</a></li><li><a class="dropdown__link" href="/blog/tags/solution-design">2 | Solution Design</a></li><li><a class="dropdown__link" href="/blog/tags/data-transformation">3 | Data Transformation (ETL)</a></li><li><a class="dropdown__link" href="/blog/tags/data-model">4 | Data Model</a></li><li><a class="dropdown__link" href="/blog/tags/data-visualization-reporting">5 | Data Visualization &amp; Reporting</a></li><li><a class="dropdown__link" href="/blog/tags/publishing-sharing">6 | Publishing &amp; Sharing</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/jon-cajacob/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.datavision.ch" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DataVision AG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome &amp; About this Wiki</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/business-intelligence--analytics-with-microsoft-power-bi-book-in-progress">Business Intelligence &amp; Analytics with Microsoft Power BI (Book in progress)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Business Intelligence &amp; Analytics with Microsoft Power BI (Book in progress)&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/1--introduction">1 | Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;1 | Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/2--overview">2 | Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;2 | Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/category/3--preparing-the-data">3 | Preparing the data</a><button aria-label="Toggle the collapsible sidebar category &#x27;3 | Preparing the data&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.1">3.1 | Chapter overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.2">3.2 | Connecting Power BI with the example data Excel file</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/3.3">3.3 | Preparing the customer dimension (dimCustomer)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.4">3.4 | Preparing the product dimension (dimProduct)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.5">3.5 | Preparing the sales channel dimension (dimSalesChannel)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.6">3.6 | Preparing the date dimension (dimDate)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.7">3.7 | Preparing the sales fact table (factSales)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.8">3.8 | Preparing the sales forecast fact table (factForecast)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/3.9">3.9 | Organizing Power Query and loading data to the data model</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/4--building-the-data-model">4 | Building the data model</a><button aria-label="Toggle the collapsible sidebar category &#x27;4 | Building the data model&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/5--creating-the-measures-visualizations-and-dashboards">5 | Creating the measures, visualizations and dashboards</a><button aria-label="Toggle the collapsible sidebar category &#x27;5 | Creating the measures, visualizations and dashboards&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/6--publishing-and-sharing-datasets-and-reports-power-bi-service">6 | Publishing and sharing datasets and reports (Power BI Service)</a><button aria-label="Toggle the collapsible sidebar category &#x27;6 | Publishing and sharing datasets and reports (Power BI Service)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/7--guest-chapter-implementing-power-bi-for-the-financial-controlling-department">7 | [Guest Chapter: Implementing Power BI for the Financial Controlling department]</a><button aria-label="Toggle the collapsible sidebar category &#x27;7 | [Guest Chapter: Implementing Power BI for the Financial Controlling department]&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/8--collection-of-topics">8 | Collection of topics</a><button aria-label="Toggle the collapsible sidebar category &#x27;8 | Collection of topics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/9--appendix">9 | Appendix</a><button aria-label="Toggle the collapsible sidebar category &#x27;9 | Appendix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/business-intelligence--analytics-with-microsoft-power-bi-book-in-progress"><span itemprop="name">Business Intelligence &amp; Analytics with Microsoft Power BI (Book in progress)</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/3--preparing-the-data"><span itemprop="name">3 | Preparing the data</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">3.3 | Preparing the customer dimension (dimCustomer)</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>3.3 | Preparing the customer dimension (<em>dimCustomer</em>)</h1><p>After connecting the Excel file and its data tables, we will now proceed with preparing the individual dimension and fact tables using data transformation steps in Power Query. The first dimension we will prepare is the customer dimension containing respective master data.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-inspect-the-raw-data-table">1. Inspect the (raw) data table<a href="#1-inspect-the-raw-data-table" class="hash-link" aria-label="Direct link to 1. Inspect the (raw) data table" title="Direct link to 1. Inspect the (raw) data table">​</a></h4><p>First, let&#x27;s have a look at the customer data table <em>dimCustomer</em> in order to understand the transformations we have to apply to the data.</p><p>When connecting with the Excel file, Power BI has automatically applied some basic steps to the table as we can see on the right side under <em>APPLIED STEPS</em>:</p><p><img loading="lazy" alt="03-4" src="/assets/images/img_book_03-4-ea2c295e8aff384d85ab801f8dfd248f.png" width="1321" height="880" class="img_ev3q"></p><p>The steps <em>Source</em> and <em>Navigation</em> are needed in order for Power BI know where the Excel file is saved and which Excel worksheet we want to use.</p><p>The steps <em>Promoted Headers</em> and <em>Changed Type</em> are also generated automatically and it is an attempt of Power BI to identify table headers and set the columns to each appropriate data type. However, we can already see that there is a problem with the column headers as they are actually on row 3 in the Excel worksheet. Therefore, let&#x27;s delete the last two steps and start from there.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-delete-the-automatically-generated-steps-promoted-headers-and-changed-type">2. Delete the automatically generated steps <em>Promoted Headers</em> and <em>Changed Type</em><a href="#2-delete-the-automatically-generated-steps-promoted-headers-and-changed-type" class="hash-link" aria-label="Direct link to 2-delete-the-automatically-generated-steps-promoted-headers-and-changed-type" title="Direct link to 2-delete-the-automatically-generated-steps-promoted-headers-and-changed-type">​</a></h4><p><img loading="lazy" alt="03-5" src="/assets/images/img_book_03-5-3172c374a7b71116380596022cf22f80.png" width="1175" height="717" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-remove-the-first-two-rows-before-promoting-the-header-row">3. Remove the first two rows before promoting the header row<a href="#3-remove-the-first-two-rows-before-promoting-the-header-row" class="hash-link" aria-label="Direct link to 3. Remove the first two rows before promoting the header row" title="Direct link to 3. Remove the first two rows before promoting the header row">​</a></h4><p>As we have noted, in the data table, actual column headers are in row number 3. Therefore, we first remove the first two rows and then we promote the resulting top row to become our table headers.</p><p><em>Home → Remove Rows → Remove Top Rows</em></p><p><img loading="lazy" alt="03-6" src="/assets/images/img_book_03-6-68560c50544e745fce96327e7834a9c5.png" width="1316" height="400" class="img_ev3q"></p><p>In the appearing window, enter <strong>2</strong> and confirm with <em>OK</em>:</p><p><img loading="lazy" alt="03-7" src="/assets/images/img_book_03-7-cb7b502aa9e624936a877738ce73952a.png" width="1174" height="291" class="img_ev3q"></p><p>You can now see on the right that an additional step has been generated called <em>Removed Top Rows</em>.</p><p>Now, promote the top row to become the table headers:</p><p><img loading="lazy" alt="03-8" src="/assets/images/img_book_03-8-2410e246dc8d17feb9a3479ac4399e3b.png" width="1321" height="438" class="img_ev3q"></p><p>You should now see the correct column headers and an additional step has been recorded.</p><p>Please delete the automatically created step <em>Changed Type</em>.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>By clicking on the individual steps in <em>APPLIED STEPS</em>, you can see intermediate results in the data transformation process. Further, note that newly added steps are always put directly after the currently selected step. Steps can be dragged-and-dropped to change the order, however this may lead to errors when steps depend on each other.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-select-the-columns-needed">4. Select the columns needed<a href="#4-select-the-columns-needed" class="hash-link" aria-label="Direct link to 4. Select the columns needed" title="Direct link to 4. Select the columns needed">​</a></h4><p>An important step in each ETL process is the selection of the columns that are needed.</p><p><em>Home → Choose Columns</em></p><p><img loading="lazy" alt="03-9" src="/assets/images/img_book_03-9-f9f022b5cc74c19ba4b207d68e76abac.png" width="1317" height="435" class="img_ev3q"></p><p>Select the columns <em>Customer ID</em>, <em>Customer Desc</em>, <em>Region</em>, <em>Country</em> and <em>Segment</em>. Note, often when we work with Excel as a data source there are additional columns loaded which are empty and not needed (here <em>Column6</em>, <em>Column7</em> etc.)</p><p><img loading="lazy" alt="03-10" src="/assets/images/img_book_03-10-039055c6a81dda5a801ed6198833bca5.png" width="1305" height="727" class="img_ev3q"></p><p><strong>Alternatively</strong>, hold the <em>CTRL</em> key on your keyboard and select with your mouse all the columns. Then do a right-click into one of the column headers and select <em>Remove Other Columns</em>:</p><p><img loading="lazy" alt="03-11" src="/assets/images/img_book_03-11-210da6e886e45945291dc2de0f4985f6.png" width="1317" height="564" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>There are many features and options available via <strong>right-click on a column header</strong>.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-set-the-data-type-for-each-column">5. Set the data type for each column<a href="#5-set-the-data-type-for-each-column" class="hash-link" aria-label="Direct link to 5. Set the data type for each column" title="Direct link to 5. Set the data type for each column">​</a></h4><p>As I have outlined in <a href="/2.3#223--using-the-right-data-types-for-table-columns"><ins>chapter VERWEIS</ins></a> it is important to define the data type for each column. To do that, we click on the symbol in each table header and select the data type.</p><p><img loading="lazy" alt="03-12" src="/assets/images/img_book_03-12-b8cfa8b5f8549c73001c0031852b77d0.png" width="1322" height="643" class="img_ev3q"></p><p>As noted in <a href="/2.3#223--using-the-right-data-types-for-table-columns"><ins>chapter VERWEIS</ins></a> we want to convert all table columns to either text, date or numbers. Because we neither have dates nor do we have numerical data with which we want to perform calculations, we define all columns of <em>dimCustomer</em> to be of the type text (i.e. string in more technical terms).</p><p><strong>Alternatively</strong>, select all columns of the same type, do a right-click and change the data type for all selected columns at once.</p><p><img loading="lazy" alt="03-13" src="/assets/images/img_book_03-13-edda99a7918c2446b9d9425f67a1354b.png" width="1323" height="792" class="img_ev3q"></p><p>As you can note, there was only one transformation step recorded <em>Changed Type</em> although we changed the data type of multiple columns.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-capitalize-all-words-in-column-segment">6. Capitalize all words in column <em>Segment</em><a href="#6-capitalize-all-words-in-column-segment" class="hash-link" aria-label="Direct link to 6-capitalize-all-words-in-column-segment" title="Direct link to 6-capitalize-all-words-in-column-segment">​</a></h4><p>Looking at the column <em>Segment</em>, we can see that all words start with lowercase letters. We can improve that with just a right-click on the column header and then follow <em>Transform → Capitalize Each Word</em>.</p><p><img loading="lazy" alt="03-14" src="/assets/images/img_book_03-14-e041e77f39bfa3f0ffa683b8e7b3f0b9.png" width="1319" height="793" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="7-replace-values-in-column-country">7. Replace values in column <em>Country</em><a href="#7-replace-values-in-column-country" class="hash-link" aria-label="Direct link to 7-replace-values-in-column-country" title="Direct link to 7-replace-values-in-column-country">​</a></h4><p>Let&#x27;s assume we are not happy with just the ISO code &quot;CH&quot; in column Country and we want to replace it with &quot;Switzerland&quot; instead. Again, just a few clicks are needed to record this transformation step:</p><p><img loading="lazy" alt="03-15" src="/assets/images/img_book_03-15-fa47aea783cc81c7530b8fc4f061cee3.png" width="1322" height="796" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8-combine-customer-id-and-customer-desc-in-a-new-custom-calculated-column">8. Combine <em>Customer ID</em> and <em>Customer Desc</em> in a new custom calculated column<a href="#8-combine-customer-id-and-customer-desc-in-a-new-custom-calculated-column" class="hash-link" aria-label="Direct link to 8-combine-customer-id-and-customer-desc-in-a-new-custom-calculated-column" title="Direct link to 8-combine-customer-id-and-customer-desc-in-a-new-custom-calculated-column">​</a></h4><p>It is often useful to combine the ID and label of an entity in a dimension table in new field. This is helpful as it allows a user to search for both the label and ID in a filter selector.</p><p>To do that, we create a new custom calculated column with an easy syntax:</p><p><em>Add Column → Custom Column</em></p><p>In the appearing window, name the new column <em>Customer</em> and enter the following code:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">New calculated column: Customer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">Customer</span><span class="token plain"> </span><span class="token maybe-class-name">Desc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; (&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">Customer</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ID</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The code used is fairly straight forward: we simply combine (or chain) two columns of type text using the &amp;-symbol and some brackets to put the ID in after the Customer label.</p><p><img loading="lazy" alt="03-16" src="/assets/images/img_book_03-16-6e3e69776f185baf2954908e61c98641.png" width="1323" height="660" class="img_ev3q"></p><p>After hitting OK, you can see the newly added column in the preview table. We also need to set the data type of the new column which will be text again. When doing so, you can see that a new step named <em>Changed Type1</em> has been created. Power Query automatically added a &quot;1&quot; in the step&#x27;s label because each transformation step has to have a unique label.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>You can change the label of a transformation step in <em>APPLIED STEPS</em> with simply double-clicking on the step and renaming it. It is helpful to rename steps with meaningful labels so other people also working on the model have it easier to have an overview of the transformation steps applied.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="9-final-step-remove-duplicates-in-column-customer-id">9. Final step: Remove duplicates in column <em>Customer ID</em><a href="#9-final-step-remove-duplicates-in-column-customer-id" class="hash-link" aria-label="Direct link to 9-final-step-remove-duplicates-in-column-customer-id" title="Direct link to 9-final-step-remove-duplicates-in-column-customer-id">​</a></h4><p>Upon careful inspection of the data, we can actually see that there are duplicate entries for the customers with ID 23 and 37:</p><p><img loading="lazy" alt="03-17" src="/assets/images/img_book_03-17-fbfcdc8d8c62a358049316d724e3d144.png" width="1323" height="874" class="img_ev3q"></p><p>This is a typical <strong>data quality issue</strong> often occuring in practice, in particular when working with data sources like text or spreadsheet files.</p><p>Given that the column <em>Customer ID</em> shall be the <strong>primary key</strong> column of <em>dimCustomer</em>, we need to make sure that all values in <em>Customer ID</em> are unique and there are no duplicates. Simply do a right-click on <em>Customer ID</em> and click on <em>Remove Duplicates</em>.</p><p><img loading="lazy" alt="03-18" src="/assets/images/img_book_03-18-cd0641077a3a49964fdb4e97b7003da5.png" width="1321" height="784" class="img_ev3q"></p><p>Please note, in a real-world application you would of course want to make sure that these issues are fixed at the data source level and not in Power Query.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>In order to quickly check a column for duplicate entries, select the column and do the following: <em>Home → Keep Rows → Keep Duplicates</em>. The table preview will only return duplicate rows.</p></div></div><p>Now our table <em>dimCustomer</em> is ready to be used in the data model.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/power-query">Power Query</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/remove-top-rows">Remove top rows</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/promote-first-row-as-headers">Promote first row as headers</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/select-columns">Select columns</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/data-types">Data types</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/replace-values">Replace values</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/calculated-column">Calculated column</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/remove-duplicates">Remove duplicates</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/3.2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">3.2 | Connecting Power BI with the example data Excel file</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/3.4"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3.4 | Preparing the product dimension (dimProduct)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-inspect-the-raw-data-table" class="table-of-contents__link toc-highlight">1. Inspect the (raw) data table</a></li><li><a href="#2-delete-the-automatically-generated-steps-promoted-headers-and-changed-type" class="table-of-contents__link toc-highlight">2. Delete the automatically generated steps <em>Promoted Headers</em> and <em>Changed Type</em></a></li><li><a href="#3-remove-the-first-two-rows-before-promoting-the-header-row" class="table-of-contents__link toc-highlight">3. Remove the first two rows before promoting the header row</a></li><li><a href="#4-select-the-columns-needed" class="table-of-contents__link toc-highlight">4. Select the columns needed</a></li><li><a href="#5-set-the-data-type-for-each-column" class="table-of-contents__link toc-highlight">5. Set the data type for each column</a></li><li><a href="#6-capitalize-all-words-in-column-segment" class="table-of-contents__link toc-highlight">6. Capitalize all words in column <em>Segment</em></a></li><li><a href="#7-replace-values-in-column-country" class="table-of-contents__link toc-highlight">7. Replace values in column <em>Country</em></a></li><li><a href="#8-combine-customer-id-and-customer-desc-in-a-new-custom-calculated-column" class="table-of-contents__link toc-highlight">8. Combine <em>Customer ID</em> and <em>Customer Desc</em> in a new custom calculated column</a></li><li><a href="#9-final-step-remove-duplicates-in-column-customer-id" class="table-of-contents__link toc-highlight">9. Final step: Remove duplicates in column <em>Customer ID</em></a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Wiki</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/category/business-intelligence--analytics-with-microsoft-power-bi-book-in-progress">Business Intelligence &amp; Analytics with Microsoft Power BI (Book work-in-progress)</a></li></ul></div><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/tags/project-management">1 | Project Management</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/solution-design">2 | Solution Design</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-transformation">3 | Data Transformation</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-model">4 | Data Model</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-visualization-reporting">5 | Data Visualization &amp; Reporting</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-visualization-reporting">6 | Publishing &amp; Sharing</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/jon-cajacob/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.datavision.ch/" target="_blank" rel="noopener noreferrer" class="footer__link-item">DataVision AG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/imprint">Imprint</a></li><li class="footer__item"><a class="footer__link-item" href="/data-privacy">Data Privacy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 A Data & Analytics Wiki by Jon Cajacob, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.06b1a5a4.js"></script>
<script src="/assets/js/main.2be230da.js"></script>
</body>
</html>