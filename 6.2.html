<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-book/chapter6/06-02-data-refresh">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">6.2 | Automated data refresh setup | A Data &amp; Analytics Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.github.com/6.2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="6.2 | Automated data refresh setup | A Data &amp; Analytics Wiki"><meta data-rh="true" name="description" content="6.2.1 | Overview"><meta data-rh="true" property="og:description" content="6.2.1 | Overview"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.github.com/6.2"><link data-rh="true" rel="alternate" href="https://www.github.com/6.2" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.github.com/6.2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="A Data &amp; Analytics Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="A Data &amp; Analytics Wiki Atom Feed"><link rel="stylesheet" href="/assets/css/styles.0e575c3e.css">
<link rel="preload" href="/assets/js/runtime~main.8cea2768.js" as="script">
<link rel="preload" href="/assets/js/main.d03afbda.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">A Data &amp; Analytics Wiki</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Wiki</a><a class="navbar__item navbar__link" href="/tags">by Tags</a><a class="navbar__item navbar__link" href="/category/business-intelligence--analytics-with-microsoft-power-bi-book-in-progress">BI &amp; Analytics with Power BI Guide</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/blog">Blog</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/blog">Overview</a></li><li><a class="dropdown__link" href="/blog/tags">All Tags</a></li><li><a class="dropdown__link" href="/blog/tags/project-management">1 | Project Management</a></li><li><a class="dropdown__link" href="/blog/tags/solution-design">2 | Solution Design</a></li><li><a class="dropdown__link" href="/blog/tags/data-transformation">3 | Data Transformation (ETL)</a></li><li><a class="dropdown__link" href="/blog/tags/data-model">4 | Data Model</a></li><li><a class="dropdown__link" href="/blog/tags/data-visualization-reporting">5 | Data Visualization &amp; Reporting</a></li><li><a class="dropdown__link" href="/blog/tags/publishing-sharing">6 | Publishing &amp; Sharing</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/jon-cajacob/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.datavision.ch" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DataVision AG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome &amp; About this Wiki</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/business-intelligence--analytics-with-microsoft-power-bi-book-in-progress">Business Intelligence &amp; Analytics with Microsoft Power BI (Book in progress)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Business Intelligence &amp; Analytics with Microsoft Power BI (Book in progress)&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/1--introduction">1 | Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;1 | Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/2--overview">2 | Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;2 | Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/3--preparing-the-data">3 | Preparing the data</a><button aria-label="Toggle the collapsible sidebar category &#x27;3 | Preparing the data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/4--building-the-data-model">4 | Building the data model</a><button aria-label="Toggle the collapsible sidebar category &#x27;4 | Building the data model&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/5--creating-the-measures-visualizations-and-dashboards">5 | Creating the measures, visualizations and dashboards</a><button aria-label="Toggle the collapsible sidebar category &#x27;5 | Creating the measures, visualizations and dashboards&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/category/6--publishing-and-sharing-datasets-and-reports-power-bi-service">6 | Publishing and sharing datasets and reports (Power BI Service)</a><button aria-label="Toggle the collapsible sidebar category &#x27;6 | Publishing and sharing datasets and reports (Power BI Service)&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/6.1">6.1 | Power BI Online platform - An overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/6.2">6.2 | Automated data refresh setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/6.3">6.3 | Working with reports to explore and analyze data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/6.4">6.4 | Data security - How access permissions are implemented</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/6.5">6.5 | Dataflows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/6.6">6.6 | Composite models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/6.7">6.7 | Workspace architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/6.8">6.8 | Implementing Power BI at scale</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/6.9">6.9 | Power BI Premium features</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/7--guest-chapter-implementing-power-bi-for-the-financial-controlling-department">7 | [Guest Chapter: Implementing Power BI for the Financial Controlling department]</a><button aria-label="Toggle the collapsible sidebar category &#x27;7 | [Guest Chapter: Implementing Power BI for the Financial Controlling department]&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/8--collection-of-topics">8 | Collection of topics</a><button aria-label="Toggle the collapsible sidebar category &#x27;8 | Collection of topics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/9--appendix">9 | Appendix</a><button aria-label="Toggle the collapsible sidebar category &#x27;9 | Appendix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/business-intelligence--analytics-with-microsoft-power-bi-book-in-progress"><span itemprop="name">Business Intelligence &amp; Analytics with Microsoft Power BI (Book in progress)</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/6--publishing-and-sharing-datasets-and-reports-power-bi-service"><span itemprop="name">6 | Publishing and sharing datasets and reports (Power BI Service)</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">6.2 | Automated data refresh setup</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>6.2 | Automated data refresh setup</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="621--overview">6.2.1 | Overview<a href="#621--overview" class="hash-link" aria-label="Direct link to 6.2.1 | Overview" title="Direct link to 6.2.1 | Overview">​</a></h2><p>The automated data refresh of datasets in the Power BI Service is one of the key features of the platform. When users open a report in the morning of a new day, you want to make sure that they are looking at the most current data.</p><p>The automated data refresh is configured per individual dataset. For all data sources to which a dataset is connected to, the data source credentials have to be provided in the dataset settings. There is an important distinction between data sources that reside in a public cloud network and those that reside in an on-premise network. For the latter, a Power BI Gateway has to be installed and kept running on a server in the on-premise network.</p><p>When installing the Power BI Gateway, it has to be registered with an e-mail address that has access to the Power BI Service. After registering, the gateway becomes visible in the Power BI Service and on-premise data sources can be configured with the respective user credentials.</p><p>Then, for each dataset that connects to on-premise data sources, the registered data connections from the gateway can be mapped accordingly in the dataset settings.</p><p>The following illustration summarizes how datasets are connected to public cloud and on-premise data sources:</p><p><img loading="lazy" alt="03-104" src="/assets/images/img_book_03-104-614dcd0e78ef7a8943b50ff2412f6185.png" width="1314" height="705" class="img_ev3q"></p><p><strong>Useful links</strong></p><ul><li>The Power BI Gateway can be downloaded here: <ins><a href="https://powerbi.microsoft.com/en-us/gateway/" target="_blank" rel="noopener noreferrer">https://powerbi.microsoft.com/en-us/gateway/</a></ins></li><li>The official documentation of the gateway can be found here: <ins><a href="https://learn.microsoft.com/en-us/power-bi/connect-data/service-gateway-onprem" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/power-bi/connect-data/service-gateway-onprem</a></ins></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="622--configuration-of-the-automated-data-refresh-for-the-demo-dataset">6.2.2 | Configuration of the automated data refresh for the demo dataset<a href="#622--configuration-of-the-automated-data-refresh-for-the-demo-dataset" class="hash-link" aria-label="Direct link to 6.2.2 | Configuration of the automated data refresh for the demo dataset" title="Direct link to 6.2.2 | Configuration of the automated data refresh for the demo dataset">​</a></h2><p>The best way to demonstrate how to set up the automated data refresh for a dataset is to do exactly that for our demo data model that we created in the earlier chapters.</p><p>For this configuration to be possible for you, the following <strong>requirements</strong> have to be met:</p><ul><li>You have access to a Power BI Service tenant</li><li>Your user has a Power BI Pro license (alternatively, the 60 day trial is sufficient)</li><li>You have at least the basic version of Microsoft 365 with the Excel app</li><li>You are able to save a file in a Microsoft Sharepoint folder</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-store-the-excel-file-containing-the-demo-data-on-your-sharepoint-and-retrieve-the-direct-url-to-the-file">1. Store the Excel file containing the demo data on your Sharepoint and retrieve the direct URL to the file<a href="#1-store-the-excel-file-containing-the-demo-data-on-your-sharepoint-and-retrieve-the-direct-url-to-the-file" class="hash-link" aria-label="Direct link to 1. Store the Excel file containing the demo data on your Sharepoint and retrieve the direct URL to the file" title="Direct link to 1. Store the Excel file containing the demo data on your Sharepoint and retrieve the direct URL to the file">​</a></h4><p>Please note, the file can also be stored in a OneDrive synced folder. In the background, the file will still be stored in your Sharepoint tenant.</p><p>When you have stored the file on your Sharepoint, navigate to it and open it inside your browser. Then, from there, open the file on the Desktop as following:</p><p><img loading="lazy" alt="03-105" src="/assets/images/img_book_03-105-9d1fc53db29b7035206aa1e0a4eb8661.png" width="1319" height="891" class="img_ev3q"></p><p>Continuing in the desktop version of Excel, navigate via <em>File</em> to <em>Info</em> and click on <em>Copy path</em>:</p><p><img loading="lazy" alt="03-106" src="/assets/images/img_book_03-106-e0da95b9104893f1f1b3c905d2f9b103.png" width="1314" height="885" class="img_ev3q"></p><p>The copied URL should look like the following:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Direct URL to Excel file saved on Sharepoint</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yourcompany</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sharepoint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">path</span><span class="token spread operator" style="color:#393A34">...</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">File</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">xlsx</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">web</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To test the URL, simply paste it into your browser and it should directly lead to the opened File via the Excel app.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-adjust-the-url">2. Adjust the URL<a href="#2-adjust-the-url" class="hash-link" aria-label="Direct link to 2. Adjust the URL" title="Direct link to 2. Adjust the URL">​</a></h4><p>For the URL to work in Power BI, we need to trim the end of it a bit. Please remove the part after the question mark and your link should then look like the following:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Final URL to be used in Power BI</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yourcompany</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sharepoint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">path</span><span class="token spread operator" style="color:#393A34">...</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">File</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">xlsx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-open-the-power-query-editor-and-replace-the-data-source-connector-in-all-queries-connecting-to-the-demo-data-file">3. Open the Power Query editor and replace the data source connector in all queries connecting to the demo data file<a href="#3-open-the-power-query-editor-and-replace-the-data-source-connector-in-all-queries-connecting-to-the-demo-data-file" class="hash-link" aria-label="Direct link to 3. Open the Power Query editor and replace the data source connector in all queries connecting to the demo data file" title="Direct link to 3. Open the Power Query editor and replace the data source connector in all queries connecting to the demo data file">​</a></h4><p>Remember, currently our Power BI file connects to the demo data via the standard Excel connector whereby the source file was stored somewhere on the local computer. Now we will replace this connector with one that points to the direct URL of the file saved on Sharepoint in the Microsoft 365 cloud.</p><p>First, let&#x27;s prepare the M-code we need for the new data connection:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">New data connection in Power Query</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Excel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">Workbook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Web</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">Contents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;https://yourcompany.sharepoint.com/path.../File.xlsx&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure you use the URL prepared in the previous step between the quotation marks in the code snippet.</p><p>In Power Query, navigate to <em>factSales</em> and the step <em>Source</em>. Replace the code with the new code-snippet:</p><p><img loading="lazy" alt="03-107" src="/assets/images/img_book_03-107-bceaff14ae2b1d233a03d75dee1fdb1b.png" width="1326" height="664" class="img_ev3q"></p><p>When you do this for the first time, Power Query will ask you for the <strong>credentials</strong> to connect with the respective Sharepoint. Click on <em>Edit Credentials</em> in the yellow bar and the following small window opens:</p><p><img loading="lazy" alt="03-108" src="/assets/images/img_book_03-108-8a3b5abd51256f34eb67c067d6070bc2.png" width="1303" height="341" class="img_ev3q"></p><p>Because the data source is on a Sharepoint we can select <em>Organizational account</em> as the authentication method. Then, click on <em>Sign in</em> and you will be asked your MS365 account credentials. Confirm with <em>Connect</em> (green button).</p><p>You should now see the data preview as before for factSales. </p><p>Replace the code for the step Source in all queries that connect directly with the demo data file:</p><ul><li>factForecast</li><li>dimCustomer</li><li>dimProduct</li><li>helperProductCategories</li><li>dimsalesChannel</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="optional-editing-the-data-source-credentials"><em>Optional:</em> Editing the data source credentials<a href="#optional-editing-the-data-source-credentials" class="hash-link" aria-label="Direct link to optional-editing-the-data-source-credentials" title="Direct link to optional-editing-the-data-source-credentials">​</a></h4><p>To access all data source credentials used in Power Query, click on <em>Data source settings</em> in the <em>Home</em> ribbon:</p><p><img loading="lazy" alt="03-113" src="/assets/images/img_book_03-113-05096de643b860d6b47568688cdae856.png" width="1322" height="862" class="img_ev3q"></p><p>In the appearing window, you can select a data source and then edit its credential via <em>Edit Premissions.</em></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-save-the-pbix-file-and-publish-it-to-a-workspace-on-the-power-bi-service">4. Save the PBIX file and publish it to a workspace on the Power BI Service<a href="#4-save-the-pbix-file-and-publish-it-to-a-workspace-on-the-power-bi-service" class="hash-link" aria-label="Direct link to 4. Save the PBIX file and publish it to a workspace on the Power BI Service" title="Direct link to 4. Save the PBIX file and publish it to a workspace on the Power BI Service">​</a></h4><p>You can either overwrite the existing dataset or add a new one with a different name.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-go-to-the-dataset-settings-and-provide-the-data-source-credentials">5. Go to the dataset settings and provide the data source credentials<a href="#5-go-to-the-dataset-settings-and-provide-the-data-source-credentials" class="hash-link" aria-label="Direct link to 5. Go to the dataset settings and provide the data source credentials" title="Direct link to 5. Go to the dataset settings and provide the data source credentials">​</a></h4><p>In the dataset settings, navigate to <em>Data source credentials</em>. A single line with &quot;Web&quot; in front of it should be visible:</p><p><img loading="lazy" alt="03-109" src="/assets/images/img_book_03-109-ac901ca51b5842932a8c4d3b2bc33f25.png" width="1321" height="827" class="img_ev3q"></p><p>Click on Edit credentials and the in the appearing window, set the <em>Authentication method</em> to &quot;OAuth2&quot; and the <em>Privacy level</em> to &quot;Organizational&quot;. Then, click on Sign in and you will be asked to provide your MS365 account credentials.</p><p><img loading="lazy" alt="03-110" src="/assets/images/img_book_03-110-32319f380398c43ef1be735038a0b024.png" width="1309" height="451" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-test-the-data-refresh">6. Test the data refresh<a href="#6-test-the-data-refresh" class="hash-link" aria-label="Direct link to 6. Test the data refresh" title="Direct link to 6. Test the data refresh">​</a></h4><p>Navigate back to the workspace overview and then initate the data refresh for the just configured dataset:</p><p><img loading="lazy" alt="03-111" src="/assets/images/img_book_03-111-78fcf5f94c900a77b21adb090883141b.png" width="1321" height="665" class="img_ev3q"></p><p>The refresh should then run a few minutes (probably even just a few seconds because it is not much data), indicated by a turning circle symbol in the column <em>Refreshed</em>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="7-configure-the-scheduled-data-refresh">7. Configure the scheduled data refresh<a href="#7-configure-the-scheduled-data-refresh" class="hash-link" aria-label="Direct link to 7. Configure the scheduled data refresh" title="Direct link to 7. Configure the scheduled data refresh">​</a></h4><p>Navigate again to the dataset settings and scroll down to <em>Scheduled refresh</em>.</p><p>Turn the scheduled refresh on via the button, make sure you have selected the appropriate time zone, select the frequency of the refresh and finally add the times you want the dataset to be refreshed:</p><p><img loading="lazy" alt="03-112" src="/assets/images/img_book_03-112-04a8bee8992780ce67f5d31a81c00309.png" width="1321" height="860" class="img_ev3q"></p><p>Note, you can configure the refresh to run up to eight times a day for the Power BI Pro license.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="8-have-a-look-at-the-lineage-for-the-dataset">8. Have a look at the lineage for the dataset<a href="#8-have-a-look-at-the-lineage-for-the-dataset" class="hash-link" aria-label="Direct link to 8. Have a look at the lineage for the dataset" title="Direct link to 8. Have a look at the lineage for the dataset">​</a></h4><p>One very useful tool in the Power BI Service is the ability to have the data lineage of a dataset being visualized as an overview.</p><p>To view the lineage of a dataset, hover over it in the workspace and click on the three dots. Then use <em>View lineage</em> to open the data lineage:</p><p><img loading="lazy" alt="03-114" src="/assets/images/img_book_03-114-8c90c40f4dfdfc831dcbda0928b3776b.png" width="1322" height="858" class="img_ev3q"></p><p>You should then see something like the following. It basically tells us that there is an Excel workbook used as a data source that resides on a Sharepoint. The lineage also tells us that the dataset has currently one report attached to it.</p><p><img loading="lazy" alt="03-115" src="/assets/images/img_book_03-115-c1ad4f88f97a93eba4fadfbb69232497.png" width="1315" height="880" class="img_ev3q"></p><p>As you can imagine, in use-cases with many different data sources and maybe even multiple reports per dataset, the lineage view can be very useful to quickly visualize and understand dependencies.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/power-bi-service">Power BI Service</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/scheduled-data-refresh">Scheduled data refresh</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/power-bi-gateway">Power BI Gateway</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/data-lineage">Data lineage</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/6.1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">6.1 | Power BI Online platform - An overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/6.3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">6.3 | Working with reports to explore and analyze data</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#621--overview" class="table-of-contents__link toc-highlight">6.2.1 | Overview</a></li><li><a href="#622--configuration-of-the-automated-data-refresh-for-the-demo-dataset" class="table-of-contents__link toc-highlight">6.2.2 | Configuration of the automated data refresh for the demo dataset</a><ul><li><a href="#1-store-the-excel-file-containing-the-demo-data-on-your-sharepoint-and-retrieve-the-direct-url-to-the-file" class="table-of-contents__link toc-highlight">1. Store the Excel file containing the demo data on your Sharepoint and retrieve the direct URL to the file</a></li><li><a href="#2-adjust-the-url" class="table-of-contents__link toc-highlight">2. Adjust the URL</a></li><li><a href="#3-open-the-power-query-editor-and-replace-the-data-source-connector-in-all-queries-connecting-to-the-demo-data-file" class="table-of-contents__link toc-highlight">3. Open the Power Query editor and replace the data source connector in all queries connecting to the demo data file</a></li><li><a href="#optional-editing-the-data-source-credentials" class="table-of-contents__link toc-highlight"><em>Optional:</em> Editing the data source credentials</a></li><li><a href="#4-save-the-pbix-file-and-publish-it-to-a-workspace-on-the-power-bi-service" class="table-of-contents__link toc-highlight">4. Save the PBIX file and publish it to a workspace on the Power BI Service</a></li><li><a href="#5-go-to-the-dataset-settings-and-provide-the-data-source-credentials" class="table-of-contents__link toc-highlight">5. Go to the dataset settings and provide the data source credentials</a></li><li><a href="#6-test-the-data-refresh" class="table-of-contents__link toc-highlight">6. Test the data refresh</a></li><li><a href="#7-configure-the-scheduled-data-refresh" class="table-of-contents__link toc-highlight">7. Configure the scheduled data refresh</a></li><li><a href="#8-have-a-look-at-the-lineage-for-the-dataset" class="table-of-contents__link toc-highlight">8. Have a look at the lineage for the dataset</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Wiki</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/category/business-intelligence--analytics-with-microsoft-power-bi-book-in-progress">Business Intelligence &amp; Analytics with Microsoft Power BI (Book work-in-progress)</a></li></ul></div><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/tags/project-management">1 | Project Management</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/solution-design">2 | Solution Design</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-transformation">3 | Data Transformation</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-model">4 | Data Model</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-visualization-reporting">5 | Data Visualization &amp; Reporting</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/tags/data-visualization-reporting">6 | Publishing &amp; Sharing</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/jon-cajacob/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.datavision.ch/" target="_blank" rel="noopener noreferrer" class="footer__link-item">DataVision AG<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/imprint">Imprint</a></li><li class="footer__item"><a class="footer__link-item" href="/data-privacy">Data Privacy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 A Data & Analytics Wiki by Jon Cajacob, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8cea2768.js"></script>
<script src="/assets/js/main.d03afbda.js"></script>
</body>
</html>